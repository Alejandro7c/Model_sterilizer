/*-----------------------------------------------------------------------------------------
 LIBRARY: STERILIZER
 FILE: Propiedades_Santos
 CREATION DATE: 28/10/2020
-----------------------------------------------------------------------------------------*/
/*-----------------------------------------------------------------------------------------
 LIBRARY: STERILIZER
 FILE: propiedades
 CREATION DATE: 02/04/2020
-----------------------------------------------------------------------------------------*/
-- Bibliotecas
USE MATH

ENUM Comp = {H2O}
SET_OF(Comp)agua ={H2O}

ENUM products ={RO200_w,RO80_w,RO200_o,RO80_o}
SET_OF (products) RO80_water = {RO80_w}
SET_OF (products) RO200_water = {RO200_w}
SET_OF (products) RO80_oil = {RO80_o}
SET_OF (products) RO200_oil = {RO200_o}


CONST REAL PM[Comp]={18.0153} UNITS u_kg_kmol "Pesos moleculares"
CONST REAL TC[Comp] = {647.096}  UNITS u_K "Temperatura crítica" 
CONST REAL PC[Comp] = {220.554128} UNITS u_Pa "Presion critica del agua"
CONST REAL FCM =1e-6 UNITS no_units "Factor de conversión a MPa y MJ"
CONST REAL DHVLDP[Comp,7] = {{5.66E+07, 0.61204, -0.257,	0.3988, 0, 273.16, 647.1}} 
CONST REAL DIPPR_116[Comp,7] = {{17.863, 58.606, -95.396, 213.89, -141.26, 0.01, 373.95}} 
CONST REAL PLXANT[Comp,9] = {{73.649, -7258.2, 0, 0, -7.3037, 4.17E-06, 2, 273.16, 647.1}}
CONST REAL R = FCM*8314.5  --m^3 MPa/(K kmol) Constante de los gases ideales

PRIVATE CONST STRING u_MJ_kmol						=	"MJ/kmol" 		"MegaJoules per kilomole"
PRIVATE CONST STRING u_MJ								=	"MJ" 			"MegaJoule"
PRIVATE CONST STRING u_MW_m2K 						= 	"MW/(m^2·degK)" 			"MegaWatts per square metre - Kelvin"

-----------------------------------------------------------------------------
-----------------------------------------------------------------------------
-------------  PROPIEDADES DE AGUA Y DE VAPOR DE AGUA -----------------------
----------------------------------------------------------------------------- 
-----------------------------------------------------------------------------


------------------------------------------------------------------------------
-- Presión y temperatura de Saturación.
-------------------------------------------------------------------------------
-- PRESIÓN DE SATURACIÓN (bar) en función de la temperatura (ºC) del vapor de agua

FUNCTION REAL pres_sat_w (REAL T)
DECLS
	REAL P
BODY

	P = exp (11.68346 - 3816.44 / (T + 273.15 - 46.13)) 

	RETURN P

END FUNCTION


------------------------------------------------------------------------
-- TEMPERATURA DE SATURACIÓN (ºC) del vapor de agua en función de presión (bar)

FUNCTION REAL temp_sat_w (REAL P)
DECLS
	REAL Tsat
BODY

	Tsat= (3816.44/(11.68346 - log(max(P,1.e-12)))+ 46.13) - 273.15

	RETURN Tsat

END FUNCTION

------------------------------------------------------------------------
-- CALOR LATENTE DE VAPORIZACIÓN (kJ/kg) en función de la presión (bar)

FUNCTION REAL c_lat_vap_w (REAL P)
DECLS
	REAL	Tsat
	REAL	landa
BODY

	Tsat=temp_sat_w(P)
	landa=(5.9893*10**2+Tsat*(-6.19*10**-1+Tsat*(6.82*10**-4+Tsat*(-4.86*10**-6))))*4.184

RETURN landa

END FUNCTION


-------------------------------------------------------------------------
------- PROPIEDADES DEL AGUA COMO LÍQUIDO ------------------------------- 
-------------------------------------------------------------------------

-- ENTALPÍA ESPECÍFICA de agua (kJ/kg) en función de la temperatura (ºC)

FUNCTION REAL entalp_w (REAL T)
DECLS
	REAL h

	CONST TABLE_1D entalp_w = { {4.00, 8.00, 12.00, 16.00, 20.00, 24.00, 28.00, 28.96, 32.00, 36.00, \
				36.16, 40.00, 41.51, 45.00, 45.81, 50.00, 55.00, 60.00, 65.00, 69.10, 70.00, 75.00, \
				75.87, 80.00, 81.33, 85.00, 85.94, 90.00, 93.50, 95.00, 96.71, 99.63, 110.0, 111.4, \
				120.0, 120.2, 127.4, 130.0, 133.6, 138.9, 140.0, 143.6, 147.9, 150.0, 151.9, 158.9, \
				160.0, 165.0, 170.0, 170.4, 175.4, 180.0, 190.0, 198.3, 200.0, 210.0, 212.4, 220.0, \
				224.0, 230.0, 233.9, 240.0, 242.6, 250.0, 250.4, 257.5, 260.0, 264.0, 270.0, 275.6, \
				280.0, 285.9, 290.0, 295.1, 300.0, 303.4, 311.1, 318.2, 320.0, 324.8, 330.9, 336.8, \
				340.0, 342.2}, \
				{16.78, 33.60, 50.41, 67.19, 83.96, 100.70, 117.43, 121.46, 134.15, 150.86, 151.53, 167.57, \
		 		 173.88, 188.45, 191.83, 209.33, 230.23, 251.13, 272.06, 289.23, 292.98, 313.93, 317.58, \
				 334.91, 340.49, 355.90, 359.86, 376.92, 391.66, 397.96, 405.15, 417.46, 461.30, 467.11, \
				 503.71, 504.70, 535.37, 546.31, 561.47, 584.33, 589.13, 604.74, 623.25, 632.20, 640.23, \
				 670.56, 675.55, 697.22, 719.21, 721.11, 742.83, 763.22, 807.62, 844.84, 852.45, 897.76, \
				 908.79, 943.62, 962.11, 990.12, 1008.4, 1037.3, 1049.8, 1085.4, 1087.3, 1121.9, 1134.4, \
				 1154.2, 1184.5, 1213.4, 1236.0, 1267.0, 1289.1, 1316.6, 1344.0, 1363.3, 1407.6, 1450.1, \
				 1461.5, 1491.3, 1531.5, 1571.1, 1594.2, 1610.5} }
BODY
	h = linearInterp1D (entalp_w, T)
	RETURN h
END FUNCTION


---------------------------------------------------------------------------
-- DENSIDAD (kg/m3) del agua líquido saturado en función de la temperatura (ºC)

FUNCTION REAL den_w (IN REAL T)
DECLS
	REAL den
	
	CONST TABLE_1D den_w = { {4.00, 8.00, 12.00, 16.00, 20.00, 24.00, 28.00, 28.96, 32.00, 36.00, 36.16, 40.00, \
				41.51, 45.00, 45.81, 50.00, 55.00, 60.00, 65.00, 69.10, 70.00, 75.00, 75.87, 80.00, 81.33, \
				85.00, 85.94, 90.00, 93.50, 95.00, 96.71, 99.63, 110.0, 111.4, 120.0, 120.2, 127.4, 130.0, \
				133.6, 138.9, 140.0, 143.6, 147.9, 150.0, 151.9, 158.9, 160.0, 165.0, 170.0, 170.4, 175.4, \
				180.0, 190.0, 198.3, 200.0, 210.0, 212.4, 220.0, 224.0, 230.0, 233.9, 240.0, 242.6, 250.0, \
				250.4, 257.5, 260.0, 264.0, 270.0, 275.6, 280.0, 285.9, 290.0, 295.1, 300.0, 303.4, 311.1, \
				318.2, 320.0, 324.8, 330.9, 336.8, 340.0, 342.2}, \
				{999.900, 999.800, 999.500, 998.901, 998.203, 997.307, 996.314, 996.016, 995.025, 993.739, \
				 993.641, 992.260, 991.670, 990.197, 989.903, 988.045, 985.610, 983.091, 980.488, 978.186, \
				 977.708, 974.754, 974.184, 971.723, 970.874, 968.523, 967.961, 965.251, 963.391, 961.816, \
				 960.615, 958.589, 950.932, 949.848, 943.129, 942.951, 937.031, 934.842, 931.793, 927.128, \
				 926.183, 922.850, 918.949, 917.011, 915.248, 908.595, 907.441, 902.527, 897.424, 897.022, \
				 891.902, 886.997, 876.117, 866.626, 864.678, 852.806, 849.834, 840.336, 835.213, 827.267, \
				 822.030, 813.603, 809.913, 799.233, 798.594, 787.898, 784.006, 777.665, 767.872, 758.323, \
				 750.694, 740.028, 732.279, 722.439, 712.454, 705.318, 688.516, 671.772, 667.200, 655.008, \
				 638.121, 620.848, 610.538, 603.100} }
BODY
	den = linearInterp1D (den_w, T)
	RETURN den
END FUNCTION


---------------------------------------------------------------------------------
-- TEMPERATURA (ºC) de agua saturada en función de la entalpía específica (kJ/kg)

TABLE_1D Twsat_H = { {16.78, 33.60, 50.41, 67.19, 83.96, 100.70, 117.43, 121.46, 134.15, 150.86, 151.53, \
		167.57, 173.88, 188.45, 191.83, 209.33, 230.23, 251.13, 272.06, 289.23, 292.98, 313.93, \
		317.58, 334.91, 340.49, 355.90, 359.86, 376.92, 391.66, 397.96, 405.15, 417.46, 461.30, \
		467.11, 503.71, 504.70, 535.37, 546.31, 561.47, 584.33, 589.13, 604.74, 623.25, 632.20, \
		640.23, 670.56, 675.55, 697.22, 719.21, 721.11, 742.83, 763.22, 807.62, 844.84, 852.45, \
		897.76, 908.79, 943.62, 962.11, 990.12, 1008.4, 1037.3, 1049.8, 1085.4, 1087.3, 1121.9, \
		1134.4, 1154.2, 1184.5, 1213.4, 1236.0, 1267.0, 1289.1, 1316.6, 1344.0, 1363.3, 1407.6, \
		1450.1, 1461.5, 1491.3, 1531.5, 1571.1, 1594.2, 1610.5}, \
		{4.00, 8.00, 12.00, 16.00, 20.00, 24.00, 28.00, 28.96, 32.00, 36.00, 36.16, 40.00, \
		 41.51, 45.00, 45.81, 50.00, 55.00, 60.00, 65.00, 69.10, 70.00, 75.00, 75.87, 80.00, 81.33, \
		 85.00, 85.94, 90.00, 93.50, 95.00, 96.71, 99.63, 110.0, 111.4, 120.0, 120.2, 127.4, 130.0, \
		 133.6, 138.9, 140.0, 143.6, 147.9, 150.0, 151.9, 158.9, 160.0, 165.0, 170.0, 170.4, 175.4, \
		 180.0, 190.0, 198.3, 200.0, 210.0, 212.4, 220.0, 224.0, 230.0, 233.9, 240.0, 242.6, 250.0, \
		 250.4, 257.5, 260.0, 264.0, 270.0, 275.6, 280.0, 285.9, 290.0, 295.1, 300.0, 303.4, 311.1, \
		 318.2, 320.0, 324.8, 330.9, 336.8, 340.0, 342.2} }


-- TEMPERATURA (ºC) de agua saturada en función de la densidad (kJ/kg)

TABLE_1D Twsat_D = { {999.900, 999.800, 999.500, 998.901, 998.203, 997.307, 996.314, 996.016, 995.025, 993.739, \
		993.641, 992.260, 991.670, 990.197, 989.903, 988.045, 985.610, 983.091, 980.488, 978.186, \
		977.708, 974.754, 974.184, 971.723, 970.874, 968.523, 967.961, 965.251, 963.391, 961.816, \
		960.615, 958.589, 950.932, 949.848, 943.129, 942.951, 937.031, 934.842, 931.793, 927.128, \
		926.183, 922.850, 918.949, 917.011, 915.248, 908.595, 907.441, 902.527, 897.424, 897.022, \
		891.902, 886.997, 876.117, 866.626, 864.678, 852.806, 849.834, 840.336, 835.213, 827.267, \
		822.030, 813.603, 809.913, 799.233, 798.594, 787.898, 784.006, 777.665, 767.872, 758.323, \
		750.694, 740.028, 732.279, 722.439, 712.454, 705.318, 688.516, 671.772, 667.200, 655.008, \
		638.121, 620.848, 610.538, 603.100}, \
		{4.00, 8.00, 12.00, 16.00, 20.00, 24.00, 28.00, 28.96, 32.00, 36.00, 36.16, 40.00, \
		 41.51, 45.00, 45.81, 50.00, 55.00, 60.00, 65.00, 69.10, 70.00, 75.00, 75.87, 80.00, 81.33, \
		 85.00, 85.94, 90.00, 93.50, 95.00, 96.71, 99.63, 110.0, 111.4, 120.0, 120.2, 127.4, 130.0, \
		 133.6, 138.9, 140.0, 143.6, 147.9, 150.0, 151.9, 158.9, 160.0, 165.0, 170.0, 170.4, 175.4, \
		 180.0, 190.0, 198.3, 200.0, 210.0, 212.4, 220.0, 224.0, 230.0, 233.9, 240.0, 242.6, 250.0, \
		 250.4, 257.5, 260.0, 264.0, 270.0, 275.6, 280.0, 285.9, 290.0, 295.1, 300.0, 303.4, 311.1, \
		 318.2, 320.0, 324.8, 330.9, 336.8, 340.0, 342.2} }


---------------------------------------------------------------------------------
-- PRESIÓN (bar) del agua líquido saturado en función de la Densidad (kg/m3)

TABLE_1D Pwsat_D = { {999.900, 999.800, 999.500, 998.901, 998.203, 997.307, 996.314, 996.016, 995.025, 993.739, \
		993.641, 992.260, 991.670, 990.197, 989.903, 988.045, 985.610, 983.091, 980.488, 978.186, \
		977.708, 974.754, 974.184, 971.723, 970.874, 968.523, 967.961, 965.251, 963.391, 961.816, \
		960.615, 958.589, 950.932, 949.848, 943.129, 942.951, 937.031, 934.842, 931.793, 927.128, \
		926.183, 922.850, 918.949, 917.011, 915.248, 908.595, 907.441, 902.527, 897.424, 897.022, \
		891.902, 886.997, 876.117, 866.626, 864.678, 852.806, 849.834, 840.336, 835.213, 827.267, \
		822.030, 813.603, 809.913, 799.233, 798.594, 787.898, 784.006, 777.665, 767.872, 758.323, \
		750.694, 740.028, 732.279, 722.439, 712.454, 705.318, 688.516, 671.772, 667.200, 655.008, \
		638.121, 620.848, 610.538, 603.100}, \
		{0.0081, 0.0107, 0.0140, 0.0182, 0.0234, 0.0299, 0.0378, 0.0400, 0.0476, \
		 0.0595, 0.0600, 0.0738, 0.0800, 0.0959, 0.1000, 0.1235, 0.1576, 0.1994, 0.2503, 0.3000, \
		 0.3119, 0.3858, 0.4000, 0.4739, 0.5000, 0.5783, 0.6000, 0.7014, 0.8000, 0.8455, 0.9000, \
		 1.000, 1.433, 1.500, 1.985, 2.000, 2.500, 2.701, 3.000, 3.500, 3.613, 4.000, 4.500, \
		 4.758, 5.000, 6.000, 6.178, 7.000, 7.917, 8.000, 9.000, 10.02, 12.54, 15.00, 15.54, \
		 19.06, 20.00, 23.18, 25.00, 27.95, 30.00, 33.44, 35.00, 39.73, 40.00, 45.00, 46.88, \
		 50.00, 54.99, 60.00, 64.12, 70.00, 74.36, 80.00, 85.81, 90.00, 100.0, 110.0, 112.7, \
		 120.0, 130.0, 140.0, 145.9, 150.0} }
	

---------------------------------------------------------------------------------
-- CALOR ESPECÍFICO (kJ/kgºC) del agua saturada en función de la temperatura (ºC)

TABLE_1D cesp_w = { {0., 5., 10., 15., 20., 25., 30., 35., 40., 45., 50., 55., 60., 65., \
		70., 75., 80., 85., 90., 95., 100., 120., 140., 160., 180., 200., 220., 240., 260., \
		280., 300.}, \
		{4.218, 4.203, 4.193, 4.187, 4.182, 4.180, 4.180, 4.179, 4.179, 4.182, 4.182, 4.184, \
		 4.186, 4.187, 4.191, 4.191, 4.195, 4.201, 4.203, 4.210, 4.215, 4.246, 4.282, 4.339, \
		 4.411, 4.498, 4.608, 4.770, 4.991, 5.294, 5.758} }


----------------------------------------------------------------------------------
-- VISCOSIDAD (kg/ms) del agua en función de la temperatura (ºC)

TABLE_1D visc_w = { {0., 5., 10., 15., 20., 25., 30., 35., 40., 45., 50., 55., 60., 65., \
		70., 75., 80., 85., 90., 95., 100., 120., 140., 160., 180., 200., 220., 240., 260., \
		280., 300., 320., 340., 360.}, \
		{1.791e-3, 1.520e-3, 1.308e-3, 1.139e-3, 1.003e-3, 0.891e-3, 0.798e-3, 0.720e-3, 0.653e-3, \
		 0.596e-3, 0.547e-3, 0.504e-3, 0.467e-3, 0.438e-3, 0.404e-3, 0.378e-3, 0.355e-3, 0.334e-3, \
		 0.315e-3, 0.298e-3, 0.282e-3, 0.232e-3, 0.196e-3, 0.170e-3, 0.150e-3, 0.134e-3, 0.121e-3, \
		 0.110e-3, 0.102e-3, 0.093e-3, 0.086e-3, 0.078e-3, 0.070e-3, 0.060e-3} }


----------------------------------------------------------------------------------------
-- CONDUCTIVIDAD CALORÍFICA (kW/mºC) del agua en función de la temperatura (ºC)

TABLE_1D cond_w = { {0., 5., 10., 15., 20., 25., 30., 35., 40., 45., 50.,55., 60., 65., \
		70., 75., 80., 85., 90., 95., 100., 120., 140., 160., 180., 200., 220., 240., 260., \
		280., 300., 320., 340., 360.}, \
		{0.562e-3, 0.572e-3, 0.582e-3, 0.591e-3, 0.600e-3, 0.608e-3, 0.615e-3, 0.622e-3, 0.629e-3, \
		 0.635e-3, 0.641e-3, 0.646e-3, 0.651e-3, 0.655e-3, 0.659e-3, 0.663e-3, 0.669e-3, 0.670e-3, \
	 	 0.673e-3, 0.675e-3, 0.678e-3, 0.683e-3, 0.685e-3, 0.682e-3, 0.675e-3, 0.663e-3, 0.648e-3, \
		 0.629e-3, 0.606e-3, 0.578e-3, 0.545e-3, 0.506e-3, 0.461e-3, 0.412e-3} }


------------------------------------------------------------------------------------------
-- NÚMERO DE PRANDLT para el agua liquido en función de la temperatura (ºC)

TABLE_1D nPr_w = { {0., 20., 40., 60., 80., 100., 120., 140., 160., \
		180., 200., 220., 240., 260., 280., 300., 320., 340., 360.}, \
		{12.45, 6.99, 4.34, 3.00, 2.23, 1.76, 1.44, 1.23, 1.08, 0.98, \
		  0.91, 0.86, 0.84, 0.84, 0.86, 0.91, 1.02, 1.25, 2.35} }
----------------------------------------------------------------------------------------
-- ENTROPÍA ESPECÍFICA (kJ/kgK) del agua líquido en función de la temperatura (ºC)

TABLE_1D entrop_w = { {4.00, 8.00, 12.00, 16.00, 20.00, 24.00, 28.00, 28.96, 32.00, 36.00, 36.16, 40.00, \
		41.51, 45.00, 45.81, 50.00, 55.00, 60.00, 65.00, 69.10, 70.00, 75.00, 75.87, 80.00, 81.33, \
		85.00, 85.94, 90.00, 93.50, 95.00, 96.71, 99.63, 110.0, 111.4, 120.0, 120.2, 127.4, 130.0, \
		133.6, 138.9, 140.0, 143.6, 147.9, 150.0, 151.9, 158.9, 160.0, 165.0, 170.0, 170.4, 175.4, \
		180.0, 190.0, 198.3, 200.0, 210.0, 212.4, 220.0, 224.0, 230.0, 233.9, 240.0, 242.6, 250.0, \
		250.4, 257.5, 260.0, 264.0, 270.0, 275.6, 280.0, 285.9, 290.0, 295.1, 300.0, 303.4, 311.1, \
		318.2, 320.0, 324.8, 330.9, 336.8, 340.0, 342.2}, \
		{0.0610, 0.1212, 0.1806, 0.2390, 0.2966, 0.3534, 0.4093, 0.4226, 0.4644, 0.5188, 0.5210, \
		 0.5725, 0.5926, 0.6387, 0.6493, 0.7038, 0.7679, 0.8312, 0.8935, 0.9439, 0.9549, 1.0155, \
		 1.0259, 1.0753, 1.0910, 1.1343, 1.1453, 1.1925, 1.2329, 1.2500, 1.2695, 1.3026, 1.4185, \
		 1.4336, 1.5276, 1.5301, 1.6072, 1.6344, 1.6718, 1.7275, 1.7391, 1.7766, 1.8207, 1.8418, \
		 1.8607, 1.9312, 1.9427, 1.9922, 2.0419, 2.0462, 2.0946, 2.1396, 2.2359, 2.3150, 2.3309, \
		 2.4248, 2.4474, 2.5178, 2.5547, 2.6099, 2.6457, 2.7015, 2.7253, 2.7927, 2.7964, 2.8610, \
		 2.8838, 2.9202, 2.9751, 3.0267, 3.0668, 3.1211, 3.1594, 3.2068, 3.2534, 3.2858, 3.3596, \
		 3.4295, 3.4480, 3.4962, 3.5606, 3.6232, 3.6594, 3.6848} }

----------------------------------------------------------------------------------------
FUNCTION REAL entrop_agua (REAL T)
DECLS
	REAL s
BODY
	s = linearInterp1D (entrop_w, T)
	RETURN s
END FUNCTION

----------------------------------------------------------------------------------------
-- ENTRALPÍA ESPECÍFICA (kJ/kg) del agua líquido saturado en función de su entropía específica (kJ/kgK)

TABLE_1D entalp_w_entrop = { {0.0610, 0.1212, 0.1806, 0.2390, 0.2966, 0.3534, 0.4093, 0.4226, 0.4644, \
		0.5188, 0.5210, 0.5725, 0.5926, 0.6387, 0.6493, 0.7038, 0.7679, 0.8312, 0.8935, 0.9439, \
		0.9549, 1.0155, 1.0259, 1.0753, 1.0910, 1.1343, 1.1453, 1.1925, 1.2329, 1.2500, 1.2695, \
		1.3026, 1.4185, 1.4336, 1.5276, 1.5301, 1.6072, 1.6344, 1.6718, 1.7275, 1.7391, 1.7766, \
		1.8207, 1.8418, 1.8607, 1.9312, 1.9427, 1.9922, 2.0419, 2.0462, 2.0946, 2.1396, 2.2359, \
		2.3150, 2.3309, 2.4248, 2.4474, 2.5178, 2.5547, 2.6099, 2.6457, 2.7015, 2.7253, 2.7927, \
		2.7964, 2.8610, 2.8838, 2.9202, 2.9751, 3.0267, 3.0668, 3.1211, 3.1594, 3.2068, 3.2534, \
		3.2858, 3.3596, 3.4295, 3.4480, 3.4962, 3.5606, 3.6232, 3.6594, 3.6848}, \
		{16.78, 33.60, 50.41, 67.19, 83.96, 100.70, 117.43, 121.46, 134.15, 150.86, 151.53, 167.57, \
		 173.88, 188.45, 191.83, 209.33, 230.23, 251.13, 272.06, 289.23, 292.98, 313.93, 317.58, \
		 334.91, 340.49, 355.90, 359.86, 376.92, 391.66, 397.96, 405.15, 417.46, 461.30, 467.11, \
		 503.71, 504.70, 535.37, 546.31, 561.47, 584.33, 589.13, 604.74, 623.25, 632.20, 640.23, \
		 670.56, 675.55, 697.22, 719.21, 721.11, 742.83, 763.22, 807.62, 844.84, 852.45, 897.76, \
		 908.79, 943.62, 962.11, 990.12, 1008.4, 1037.3, 1049.8, 1085.4, 1087.3, 1121.9, 1134.4, \
		 1154.2, 1184.5, 1213.4, 1236.0, 1267.0, 1289.1, 1316.6, 1344.0, 1363.3, 1407.6, 1450.1, \
		 1461.5, 1491.3, 1531.5, 1571.1, 1594.2, 1610.5}}



--------------------------------------------------------------------------
--------  PROPIEDADES DEL VAPOR DE AGUA SATURADO -------------------------
--------------------------------------------------------------------------

-- DENSIDAD (kg/m3) del vapor de agua saturado en función de la presión (bar)

TABLE_1D dens_vsat = { {0.0081, 0.0107, 0.0140, 0.0182, 0.0234, 0.0299, 0.0378, 0.0400, 0.0476, \
		0.0595, 0.0600, 0.0738, 0.0800, 0.0959, 0.1000, 0.1235, 0.1576, 0.1994, 0.2503, 0.3000, \
		0.3119, 0.3858, 0.4000, 0.4739, 0.5000, 0.5783, 0.6000, 0.7014, 0.8000, 0.8455, 0.9000, \
		1.000, 1.433, 1.500, 1.985, 2.000, 2.500, 2.701, 3.000, 3.500, 3.613, 4.000, 4.500, \
		4.758, 5.000, 6.000, 6.178, 7.000, 7.917, 8.000, 9.000, 10.02, 12.54, 15.00, 15.54, \
		19.06, 20.00, 23.18, 25.00, 27.95, 30.00, 33.44, 35.00, 39.73, 40.00, 45.00, 46.88, \
		50.00, 54.99, 60.00, 64.12, 70.00, 74.36, 80.00, 85.81, 90.00, 100.0, 110.0, 112.7, \
		120.0, 130.0, 140.0, 145.9, 150.0}, \
		{0.0064, 0.0083, 0.0107, 0.0136, 0.0193, 0.0218, 0.0273, 0.0287, 0.0339, 0.0418, 0.0421, 0.0512, 0.0552, \
		 0.0655, 0.0681, 0.0831, 0.1045, 0.1304, 0.1614, 0.1912, 0.1983, 0.2421, 0.2504, 0.2935, 0.3086, 0.3536, \
		 0.3660, 0.4235, 0.4792, 0.5045, 0.5350, 0.5903, 0.8264, 0.8628, 1.1212, 1.1291, 1.3914, 1.4959, 1.6507, \
		 1.9073, 1.9650, 2.1622, 2.4155, 2.5458, 2.6674, 3.1676, 3.2563, 3.6643, 4.1186, 4.1597, 4.6512, 5.1520, \
		 6.3898, 7.5873, 7.8493, 9.5785, 10.0371, 11.6023, 12.5031, 13.9704, 14.9970, 16.7336, 17.5223, 19.9481, \
		 20.0884, 22.6963, 23.6911, 25.3550, 28.0584, 30.8261, 33.1455, 36.5364, 39.1083, 42.5170, 46.1467, \
		 48.8281, 55.4631, 62.5391, 64.5578, 70.1262, 78.2473, 87.0322, 92.5926, 96.7118} }


-- DENSIDAD (kg/m3) del vapor de agua saturado en función de la temperatura (ºC)

FUNCTION REAL den_v (REAL T)
DECLS
	REAL d

	CONST TABLE_1D den_v_T = { {4.00, 8.00, 12.00, 16.00, 20.00, 24.00, 28.00, 28.96, 32.00, 36.00, 36.16, 40.00, \
				41.51, 45.00, 45.81, 50.00, 55.00, 60.00, 65.00, 69.10, 70.00, 75.00, 75.87, 80.00, 81.33, \
				85.00, 85.94, 90.00, 93.50, 95.00, 96.71, 99.63, 110.0, 111.4, 120.0, 120.2, 127.4, 130.0, \
				133.6, 138.9, 140.0, 143.6, 147.9, 150.0, 151.9, 158.9, 160.0, 165.0, 170.0, 170.4, 175.4, \
				180.0, 190.0, 198.3, 200.0, 210.0, 212.4, 220.0, 224.0, 230.0, 233.9, 240.0, 242.6, 250.0, \
				250.4, 257.5, 260.0, 264.0, 270.0, 275.6, 280.0, 285.9, 290.0, 295.1, 300.0, 303.4, 311.1, \
				318.2, 320.0, 324.8, 330.9, 336.8, 340.0, 342.2}, \
				{0.0064, 0.0083, 0.0107, 0.0136, 0.0193, 0.0218, 0.0273, 0.0287, 0.0339, 0.0418, 0.0421, 0.0512, 0.0552, \
				 0.0655, 0.0681, 0.0831, 0.1045, 0.1304, 0.1614, 0.1912, 0.1983, 0.2421, 0.2504, 0.2935, 0.3086, 0.3536, \
				 0.3660, 0.4235, 0.4792, 0.5045, 0.5350, 0.5903, 0.8264, 0.8628, 1.1212, 1.1291, 1.3914, 1.4959, 1.6507, \
				 1.9073, 1.9650, 2.1622, 2.4155, 2.5458, 2.6674, 3.1676, 3.2563, 3.6643, 4.1186, 4.1597, 4.6512, 5.1520, \
				 6.3898, 7.5873, 7.8493, 9.5785, 10.0371, 11.6023, 12.5031, 13.9704, 14.9970, 16.7336, 17.5223, 19.9481, \
				 20.0884, 22.6963, 23.6911, 25.3550, 28.0584, 30.8261, 33.1455, 36.5364, 39.1083, 42.5170, 46.1467, \
				 48.8281, 55.4631, 62.5391, 64.5578, 70.1262, 78.2473, 87.0322, 92.5926, 96.7118} }
BODY
	d = linearInterp1D(den_v_T, T)
	RETURN d

END FUNCTION


-------------------------------------------------------------------------------------------------------------------------
-- ENTALPÍA ESPECÍFICA (kJ/kg) del vapor de agua saturado en función de la presión (bar)
---- Pbaja: hasta 30 bar, Palta: hasta 150 bar

TABLE_1D hvs_Pbaja = { {0.0081, 0.0107, 0.0140, 0.0182, 0.0234, 0.0299, 0.0378, 0.0400, 0.0476, \
		0.0595, 0.0600, 0.0738, 0.0800, 0.0959, 0.1000, 0.1235, 0.1576, 0.1994, 0.2503, 0.3000, \
		0.3119, 0.3858, 0.4000, 0.4739, 0.5000, 0.5783, 0.6000, 0.7014, 0.8000, 0.8455, 0.9000, \
		1.000, 1.433, 1.500, 1.985, 2.000, 2.500, 2.701, 3.000, 3.500, 3.613, 4.000, 4.500, \
		4.758, 5.000, 6.000, 6.178, 7.000, 7.917, 8.000, 9.000, 10.02, 12.54, 15.00, 15.54, \
		19.06, 20.00, 23.18, 25.00, 27.95, 30.00}, \
		{2508.7, 2516.1, 2523.4, 2530.8, 2538.1, 2545.4, 2552.6, 2554.4, 2559.9, 2567.1, 2567.4, 2574.3, \
		 2577.0, 2583.2, 2584.7, 2592.1, 2600.9, 2609.6, 2618.3, 2625.3, 2626.8, 2636.3, 2636.8, 2643.7, \
		 2645.9, 2651.9, 2653.5, 2660.1, 2665.8, 2668.1, 2670.9, 2675.5, 2691.5, 2693.6, 2706.3, 2706.7, \
		 2716.9, 2720.5, 2725.3, 2732.4, 2733.9, 2738.6, 2743.9, 2746.5, 2748.7, 2756.8, 2758.1, 2763.5, \
		 2768.7, 2769.1, 2773.9, 2778.2, 2786.4, 2792.2, 2793.2, 2798.5, 2799.5, 2802.1, 2803.1, 2804.0, 2804.2} }

TABLE_1D hvs_Palta = { {33.44, 35.00, 39.73, 40.00, 45.00, 46.88, \
		50.00, 54.99, 60.00, 64.12, 70.00, 74.36, 80.00, 85.81, 90.00, 100.0, 110.0, 112.7, \
		120.0, 130.0, 140.0, 145.9, 150.0}, \
		{2803.8, 2803.4, 2801.5, 2801.4, 2798.3, 2796.6, 2794.3, 2789.7, 2784.3, 2779.6, 2772.1, 2766.2, \
		 2758.0, 2749.0, 2742.1, 2724.7, 2705.6, 2700.1, 2684.9, 2662.2, 2637.6, 2622.0, 2610.5} }

---------------------------------------------------
FUNCTION REAL entalp_vsat_P (REAL P)
DECLS
	REAL H
BODY
	IF (P < 31.5) THEN
		H = linearInterp1D(hvs_Pbaja, P)
	ELSE
		H = linearInterp1D(hvs_Palta, P)
	END IF

	RETURN H
END FUNCTION	


------------------------------------------------------------------------------------------------------------------
-- ENTALPÍA ESPECÍFICA (kJ/kg) del vapor de agua saturado en función de la temperatura (ºC)
---- Tbaja: hasta 235 ºC, Talta: hasta 342ºC
TABLE_1D hvs_Tbaja = { {4.00, 8.00, 12.00, 16.00, 20.00, 24.00, 28.00, 28.96, 32.00, 36.00, 36.16, 40.00, \
		41.51, 45.00, 45.81, 50.00, 55.00, 60.00, 65.00, 69.10, 70.00, 75.00, 75.87, 80.00, 81.33, \
		85.00, 85.94, 90.00, 93.50, 95.00, 96.71, 99.63, 110.0, 111.4, 120.0, 120.2, 127.4, 130.0, \
		133.6, 138.9, 140.0, 143.6, 147.9, 150.0, 151.9, 158.9, 160.0, 165.0, 170.0, 170.4, 175.4, \
		180.0, 190.0, 198.3, 200.0, 210.0, 212.4, 220.0, 224.0, 230.0, 233.9}, \
		{2508.7, 2516.1, 2523.4, 2530.8, 2538.1, 2545.4, 2552.6, 2554.4, 2559.9, 2567.1, 2567.4, 2574.3, \
		 2577.0, 2583.2, 2584.7, 2592.1, 2600.9, 2609.6, 2618.3, 2625.3, 2626.8, 2636.3, 2636.8, 2643.7, \
		 2645.9, 2651.9, 2653.5, 2660.1, 2665.8, 2668.1, 2670.9, 2675.5, 2691.5, 2693.6, 2706.3, 2706.7, \
		 2716.9, 2720.5, 2725.3, 2732.4, 2733.9, 2738.6, 2743.9, 2746.5, 2748.7, 2756.8, 2758.1, 2763.5, \
		 2768.7, 2769.1, 2773.9, 2778.2, 2786.4, 2792.2, 2793.2, 2798.5, 2799.5, 2802.1, 2803.1, 2804.0, 2804.2} }

TABLE_1D hvs_Talta = { {240.0, 242.6, 250.0, 250.4, 257.5, 260.0, 264.0, 270.0, 275.6, 280.0, 285.9, 290.0, \
		295.1, 300.0, 303.4, 311.1, 318.2, 320.0, 324.8, 330.9, 336.8, 340.0, 342.2}, \
		{2803.8, 2803.4, 2801.5, 2801.4, 2798.3, 2796.6, 2794.3, 2789.7, 2784.3, 2779.6, 2772.1, 2766.2, \
		 2758.0, 2749.0, 2742.1, 2724.7, 2705.6, 2700.1, 2684.9, 2662.2, 2637.6, 2622.0, 2610.5} }

-------------------------------------------------
FUNCTION REAL entalp_vsat_T (REAL T)
DECLS
	REAL H
BODY
	IF (T < 235.) THEN
		H = linearInterp1D(hvs_Tbaja, T)
	ELSE
		H = linearInterp1D(hvs_Talta, T)
	END IF

	RETURN H
END FUNCTION	


-------------------------------------------------------------------------------
-- TEMPERATURA (ºC) del vapor de agua saturado en función de la densidad (kg/m3)

TABLE_1D Tvsat_D = { {0.0064, 0.0083, 0.0107, 0.0136, 0.0193, 0.0218, 0.0273, 0.0287, 0.0339, 0.0418, 0.0421, 0.0512, \
		0.0552, 0.0655, 0.0681, 0.0831, 0.1045, 0.1304, 0.1614, 0.1912, 0.1983, 0.2421, 0.2504, 0.2935, 0.3086, \
		0.3536, 0.3660, 0.4235, 0.4792, 0.5045, 0.5350, 0.5903, 0.8264, 0.8628, 1.1212, 1.1291, 1.3914, 1.4959, \
		1.6507, 1.9073, 1.9650, 2.1622, 2.4155, 2.5458, 2.6674, 3.1676, 3.2563, 3.6643, 4.1186, 4.1597, 4.6512, \
		5.1520, 6.3898, 7.5873, 7.8493, 9.5785, 10.0371, 11.6023, 12.5031, 13.9704, 14.9970, 16.7336, 17.5223, \
		19.9481, 20.0884, 22.6963, 23.6911, 25.3550, 28.0584, 30.8261, 33.1455, 36.5364, 39.1083, 42.5170, \
		46.1467, 48.8281, 55.4631, 62.5391, 64.5578, 70.1262, 78.2473, 87.0322, 92.5926, 96.7118}, \ 
		{4.00, 8.00, 12.00, 16.00, 20.00, 24.00, 28.00, 28.96, 32.00, 36.00, 36.16, 40.00, \
		 41.51, 45.00, 45.81, 50.00, 55.00, 60.00, 65.00, 69.10, 70.00, 75.00, 75.87, 80.00, 81.33, \
		 85.00, 85.94, 90.00, 93.50, 95.00, 96.71, 99.63, 110.0, 111.4, 120.0, 120.2, 127.4, 130.0, \
		 133.6, 138.9, 140.0, 143.6, 147.9, 150.0, 151.9, 158.9, 160.0, 165.0, 170.0, 170.4, 175.4, \
		 180.0, 190.0, 198.3, 200.0, 210.0, 212.4, 220.0, 224.0, 230.0, 233.9, 240.0, 242.6, 250.0, \
		 250.4, 257.5, 260.0, 264.0, 270.0, 275.6, 280.0, 285.9, 290.0, 295.1, 300.0, 303.4, 311.1, \
		 318.2, 320.0, 324.8, 330.9, 336.8, 340.0, 342.2} }


-- TEMPERATURA (ºC) del vapor de agua saturado en función de la entalpía específica (kJ/kg)
---- Tbaja: hasta 235 ºC, Talta: hasta 342ºC

	
TABLE_1D Tvs_H_baja = { {2508.7, 2516.1, 2523.4, 2530.8, 2538.1, 2545.4, 2552.6, 2554.4, 2559.9, 2567.1, 2567.4, 2574.3, \
		2577.0, 2583.2, 2584.7, 2592.1, 2600.9, 2609.6, 2618.3, 2625.3, 2626.8, 2636.3, 2636.8, 2643.7, \
		2645.9, 2651.9, 2653.5, 2660.1, 2665.8, 2668.1, 2670.9, 2675.5, 2691.5, 2693.6, 2706.3, 2706.7, \
		2716.9, 2720.5, 2725.3, 2732.4, 2733.9, 2738.6, 2743.9, 2746.5, 2748.7, 2756.8, 2758.1, 2763.5, \
		2768.7, 2769.1, 2773.9, 2778.2, 2786.4, 2792.2, 2793.2, 2798.5, 2799.5, 2802.1, 2803.1, 2804.0, 2804.2}, \
		{4.00, 8.00, 12.00, 16.00, 20.00, 24.00, 28.00, 28.96, 32.00, 36.00, 36.16, 40.00, \
		 41.51, 45.00, 45.81, 50.00, 55.00, 60.00, 65.00, 69.10, 70.00, 75.00, 75.87, 80.00, 81.33, \
		 85.00, 85.94, 90.00, 93.50, 95.00, 96.71, 99.63, 110.0, 111.4, 120.0, 120.2, 127.4, 130.0, \
		 133.6, 138.9, 140.0, 143.6, 147.9, 150.0, 151.9, 158.9, 160.0, 165.0, 170.0, 170.4, 175.4, \
		 180.0, 190.0, 198.3, 200.0, 210.0, 212.4, 220.0, 224.0, 230.0, 233.9} }

TABLE_1D Tvs_H_alta = {{2803.8, 2803.4, 2801.5, 2801.4, 2798.3, 2796.6, 2794.3, 2789.7, 2784.3, 2779.6, 2772.1, \
		2766.2, 2758.0, 2749.0, 2742.1, 2724.7, 2705.6, 2700.1, 2684.9, 2662.2, 2637.6, 2622.0, 2610.5}, \
		{240.0, 242.6, 250.0, 250.4, 257.5, 260.0, 264.0, 270.0, 275.6, 280.0, 285.9, 290.0, \
		 295.1, 300.0, 303.4, 311.1, 318.2, 320.0, 324.8, 330.9, 336.8, 340.0, 342.2} }

--------------------------------------------------------------------------------
FUNCTION REAL T_vsat_H (REAL H, REAL P)
DECLS
	REAL T
BODY
	IF (H < 2804.5 AND P <30. ) THEN
		T = linearInterp1D(Tvs_H_baja, H)
	ELSE
		T = linearInterp1D(Tvs_H_alta, H)
	END IF

	RETURN T
END FUNCTION	
--------------------------------------------------------------------------------
-- PRESIÓN (bar) del vapor de agua saturado en función de la densidad (kg/m3)

TABLE_1D Pvsat_D = { {0.0064, 0.0083, 0.0107, 0.0136, 0.0193, 0.0218, 0.0273, 0.0287, 0.0339, 0.0418, 0.0421, 0.0512, \
		0.0552, 0.0655, 0.0681, 0.0831, 0.1045, 0.1304, 0.1614, 0.1912, 0.1983, 0.2421, 0.2504, 0.2935, 0.3086, \
		0.3536, 0.3660, 0.4235, 0.4792, 0.5045, 0.5350, 0.5903, 0.8264, 0.8628, 1.1212, 1.1291, 1.3914, 1.4959, \
		1.6507, 1.9073, 1.9650, 2.1622, 2.4155, 2.5458, 2.6674, 3.1676, 3.2563, 3.6643, 4.1186, 4.1597, 4.6512, \
		5.1520, 6.3898, 7.5873, 7.8493, 9.5785, 10.0371, 11.6023, 12.5031, 13.9704, 14.9970, 16.7336, 17.5223, \
		19.9481, 20.0884, 22.6963, 23.6911, 25.3550, 28.0584, 30.8261, 33.1455, 36.5364, 39.1083, 42.5170, \
		46.1467, 48.8281, 55.4631, 62.5391, 64.5578, 70.1262, 78.2473, 87.0322, 92.5926, 96.7118}, \
		{0.0081, 0.0107, 0.0140, 0.0182, 0.0234, 0.0299, 0.0378, 0.0400, 0.0476, \
		 0.0595, 0.0600, 0.0738, 0.0800, 0.0959, 0.1000, 0.1235, 0.1576, 0.1994, 0.2503, 0.3000, 0.3119, \
		 0.3858, 0.4000, 0.4739, 0.5000, 0.5783, 0.6000, 0.7014, 0.8000, 0.8455, 0.9000, 1.000, 1.433, \
		 1.500, 1.985, 2.000, 2.500, 2.701, 3.000, 3.500, 3.613, 4.000, 4.500, 4.758, 5.000, 6.000, \
		 6.178, 7.000, 7.917, 8.000, 9.000, 10.02, 12.54, 15.00, 15.54, 19.06, 20.00, 23.18, 25.00, \
		 27.95, 30.00, 33.44, 35.00, 39.73, 40.00, 45.00, 46.88, 50.00, 54.99, 60.00, 64.12, 70.00, \
		 74.36, 80.00, 85.81, 90.00, 100.0, 110.0, 112.7, 120.0, 130.0, 140.0, 145.9, 150.0} }

--------------------------------------------------------------------------------
FUNCTION REAL P_vsat_D(REAL RHO)
DECLS
	REAL P
BODY
	P = linearInterp1D(Pvsat_D, RHO)
	RETURN P
END FUNCTION	

--------------------------------------------------------------------------------
-- CALOR ESPECÍFICO (KJ/kgºC) del vapor saturado  en función de la presión (bar)

TABLE_1D cesp_vsat = { {1., 5., 10., 15., 20., 40., 60., 80., 100., 120., 140.}, \
		{2.027, 2.329, 2.595, 2.820, 3.025, 3.788, 4.613, 5.600, 6.770, 8.158, 10.150} }


-- CALOR ESPECÍFICO (KJ/kgºC) del vapor saturado  en función de la temperatura (ºC)

TABLE_1D cesp_vsat_T = { {99.63, 151.9, 180.0 , 198.3, 212.4, 250.4, 275.6, 295.1, 311.1, 324.8, 336.8}, \
		{2.027, 2.329, 2.595, 2.820, 3.025, 3.788, 4.613, 5.600, 6.770, 8.158, 10.150} }


--------------------------------------------------------------------------------
-- VISCOSIDAD (kg/ms) del vapor saturado  en función de la presión (bar)

TABLE_1D visc_vsat = { {1., 5., 10., 15., 20., 40., 60., 80., 100., 120., 140.}, \
		{12.26e-6, 14.08e-6, 15.07e-6, 15.72e-6, 16.22e-6, 17.61e-6, 18.61e-6, 19.49e-6, 20.33e-6, 21.21e-6, 22.20e-6} }


-- VISCOSIDAD (kg/ms) del vapor saturado  en función de la temperatura (ºC)

TABLE_1D visc_vsat_T = { {99.63, 151.9, 180.0 , 198.3, 212.4, 250.4, 275.6, 295.1, 311.1, 324.8, 336.8}, \
		{12.26e-6, 14.08e-6, 15.07e-6, 15.72e-6, 16.22e-6, 17.61e-6, 18.61e-6, 19.49e-6, 20.33e-6, 21.21e-6, 22.20e-6} }


--------------------------------------------------------------------------------
-- CONDUCTIVIDAD (kW/mºC) del vapor saturado  en función de la presión (bar)

TABLE_1D cond_vsat = { {1., 5., 10., 15., 20., 40., 60., 80., 100., 120., 140.}, \
		{24.75e-6, 31.03e-6, 35.40e-6, 38.76e-6, 41.65e-6, 51.28e-6, 59.99e-6, 68.96e-6, 78.96e-6, 90.89e-6, 106.3e-6} }


-- CONDUCTIVIDAD (kW/mºC) del vapor saturado  en función de la temperatua (ºC)

TABLE_1D cond_vsat_T = { {99.63, 151.9, 180.0 , 198.3, 212.4, 250.4, 275.6, 295.1, 311.1, 324.8, 336.8}, \
		{24.75e-6, 31.03e-6, 35.40e-6, 38.76e-6, 41.65e-6, 51.28e-6, 59.99e-6, 68.96e-6, 78.96e-6, 90.89e-6, 106.3e-6} }


---------------------------------------------------------------------------------
-- NUMERO DE PRANDLT para el vapor saturado en función de la presión (bar)

TABLE_1D nPr_vsat = { {1., 5., 10., 15., 20., 40., 60., 80., 100., 120., 140.}, \
		{1.00, 1.06, 1.10, 1.14, 1.18, 1.30, 1.43, 1.58, 1.74, 1.90, 2.12} }


-- NUMERO DE PRANDLT para el vapor saturado en función de la temperatura)

TABLE_1D nPr_vsat_T = { {99.63, 151.9, 180.0 , 198.3, 212.4, 250.4, 275.6, 295.1, 311.1, 324.8, 336.8}, \
		{1.00, 1.06, 1.10, 1.14, 1.18, 1.30, 1.43, 1.58, 1.74, 1.90, 2.12} }

---------------------------------------------------------------------------------
-- ENTROPÍA ESPECÍFICA (kJ/kgK) del vapor saturado en función de la temperatura (ºC)

TABLE_1D entrop_vsat_T = { {4.00, 8.00, 12.00, 16.00, 20.00, 24.00, 28.00, 28.96, 32.00, 36.00, 36.16, 40.00, \
		41.51, 45.00, 45.81, 50.00, 55.00, 60.00, 65.00, 69.10, 70.00, 75.00, 75.87, 80.00, 81.33, \
		85.00, 85.94, 90.00, 93.50, 95.00, 96.71, 99.63, 110.0, 111.4, 120.0, 120.2, 127.4, 130.0, \
		133.6, 138.9, 140.0, 143.6, 147.9, 150.0, 151.9, 158.9, 160.0, 165.0, 170.0, 170.4, 175.4, \
		180.0, 190.0, 198.3, 200.0, 210.0, 212.4, 220.0, 224.0, 230.0, 233.9, 240.0, 242.6, 250.0, \
		250.4, 257.5, 260.0, 264.0, 270.0, 275.6, 280.0, 285.9, 290.0, 295.1, 300.0, 303.4, 311.1, \
		318.2, 320.0, 324.8, 330.9, 336.8, 340.0, 342.2}, \
		{9.0514, 8.9501, 8.8524, 8.7582, 8.6672, 8.5794, 8.4946, 8.4746, 8.4127, 8.3336, 8.3304, 8.2570, \
		 8.2287, 8.1648, 8.1502, 8.0763, 7.9913, 7.9096, 7.8310, 7.7686, 7.7553, 7.6824, 7.6700, 7.6122, \
		 7.5939, 7.5445, 7.5320, 7.4791, 7.4346, 7.4159, 7.3949, 7.3594, 7.2387, 7.2233, 7.1296, 7.1271, \
		 7.0527, 7.0269, 6.9919, 6.9405, 6.9299, 6.8959, 6.8565, 6.8379, 6.8212, 6.7600, 6.7502, 6.7080, \
		 6.6663, 6.6628, 6.6226, 6.5857, 6.5079, 6.4448, 6.4323, 6.3585, 6.3409, 6.2861, 6.2575, 6.2146, \
		 6.1869, 6.1437, 6.1253, 6.0730, 6.0701, 6.0199, 6.0019, 5.9734, 5.9301, 5.8892, 5.8571, 5.8133, \
		 5.7821, 5.7432, 5.7045, 5.6772, 5.6141, 5.5527, 5.5362, 5.4924, 5.4323, 5.3717, 5.3357, 5.3098} }


-- ENTROPÍA ESPECÍFICA (kJ/kgK) del vapor saturado en función de la presión (bar)

TABLE_1D entrop_vsat = { {0.0081, 0.0107, 0.0140, 0.0182, 0.0234, 0.0299, 0.0378, 0.0400, 0.0476, 0.0595, \
		0.0600, 0.0738, 0.0800, 0.0959, 0.1000, 0.1235, 0.1576, 0.1994, 0.2503, 0.3000, 0.3119, \
		0.3858, 0.4000, 0.4739, 0.5000, 0.5783, 0.6000, 0.7014, 0.8000, 0.8455, 0.9000, 1.000, 1.433, \
		1.500, 1.985, 2.000, 2.500, 2.701, 3.000, 3.500, 3.613, 4.000, 4.500, 4.758, 5.000, 6.000, \
		6.178, 7.000, 7.917, 8.000, 9.000, 10.02, 12.54, 15.00, 15.54, 19.06, 20.00, 23.18, 25.00, \
		27.95, 30.00, 33.44, 35.00, 39.73, 40.00, 45.00, 46.88, 50.00, 54.99, 60.00, 64.12, 70.00, \
		74.36, 80.00, 85.81, 90.00, 100.0, 110.0, 112.7, 120.0, 130.0, 140.0, 145.9, 150.0}, \
		{9.0514, 8.9501, 8.8524, 8.7582, 8.6672, 8.5794, 8.4946, 8.4746, 8.4127, 8.3336, 8.3304, 8.2570, \
		 8.2287, 8.1648, 8.1502, 8.0763, 7.9913, 7.9096, 7.8310, 7.7686, 7.7553, 7.6824, 7.6700, 7.6122, \
		 7.5939, 7.5445, 7.5320, 7.4791, 7.4346, 7.4159, 7.3949, 7.3594, 7.2387, 7.2233, 7.1296, 7.1271, \
		 7.0527, 7.0269, 6.9919, 6.9405, 6.9299, 6.8959, 6.8565, 6.8379, 6.8212, 6.7600, 6.7502, 6.7080, \
		 6.6663, 6.6628, 6.6226, 6.5857, 6.5079, 6.4448, 6.4323, 6.3585, 6.3409, 6.2861, 6.2575, 6.2146, \
		 6.1869, 6.1437, 6.1253, 6.0730, 6.0701, 6.0199, 6.0019, 5.9734, 5.9301, 5.8892, 5.8571, 5.8133, \
		 5.7821, 5.7432, 5.7045, 5.6772, 5.6141, 5.5527, 5.5362, 5.4924, 5.4323, 5.3717, 5.3357, 5.3098} }

------------------------------------------------------------------------------------------------------------------
-- ENTALPÍA ESPECÍFICA (kJ/kg) del vapor de agua saturado en función de su entropía específica (kJ/kgK)
---- Sbaja: hasta -- kJ/kgK (235 ºC), Salta: hasta -- kJ/kgK (342ºC)
TABLE_1D hvs_Sbaja = { {9.0514, 8.9501, 8.8524, 8.7582, 8.6672, 8.5794, 8.4946, 8.4746, 8.4127, 8.3336, 8.3304, \
		8.2570, 8.2287, 8.1648, 8.1502, 8.0763, 7.9913, 7.9096, 7.8310, 7.7686, 7.7553, 7.6824, 7.6700, \
		7.6122, 7.5939, 7.5445, 7.5320, 7.4791, 7.4346, 7.4159, 7.3949, 7.3594, 7.2387, 7.2233, 7.1296, \
		7.1271, 7.0527, 7.0269, 6.9919, 6.9405, 6.9299, 6.8959, 6.8565, 6.8379, 6.8212, 6.7600, 6.7502, \
		6.7080, 6.6663, 6.6628, 6.6226, 6.5857, 6.5079, 6.4448, 6.4323, 6.3585, 6.3409, 6.2861, 6.2575, \
		6.2146, 6.1869}, \
		{2508.7, 2516.1, 2523.4, 2530.8, 2538.1, 2545.4, 2552.6, 2554.4, 2559.9, 2567.1, 2567.4, 2574.3, \
		 2577.0, 2583.2, 2584.7, 2592.1, 2600.9, 2609.6, 2618.3, 2625.3, 2626.8, 2636.3, 2636.8, 2643.7, \
		 2645.9, 2651.9, 2653.5, 2660.1, 2665.8, 2668.1, 2670.9, 2675.5, 2691.5, 2693.6, 2706.3, 2706.7, \
		 2716.9, 2720.5, 2725.3, 2732.4, 2733.9, 2738.6, 2743.9, 2746.5, 2748.7, 2756.8, 2758.1, 2763.5, \
		 2768.7, 2769.1, 2773.9, 2778.2, 2786.4, 2792.2, 2793.2, 2798.5, 2799.5, 2802.1, 2803.1, 2804.0, 2804.2} }

TABLE_1D hvs_Salta = { {6.1437, 6.1253, 6.0730, 6.0701, 6.0199, 6.0019, 5.9734, 5.9301, 5.8892, 5.8571, 5.8133, \
		5.7821, 5.7432, 5.7045, 5.6772, 5.6141, 5.5527, 5.5362, 5.4924, 5.4323, 5.3717, 5.3357, 5.3098}, \
		{2803.8, 2803.4, 2801.5, 2801.4, 2798.3, 2796.6, 2794.3, 2789.7, 2784.3, 2779.6, 2772.1, 2766.2, \
		 2758.0, 2749.0, 2742.1, 2724.7, 2705.6, 2700.1, 2684.9, 2662.2, 2637.6, 2622.0, 2610.5} }

-----------------------------------------
FUNCTION REAL entalp_vsat_entrop (REAL S)
DECLS
	REAL H
BODY
	IF (S < 6.1359) THEN
		H = linearInterp1D(hvs_Sbaja, S)
	ELSE
		H = linearInterp1D(hvs_Salta, S)
	END IF

	RETURN H
END FUNCTION	

-----------------------------------------------------------------------------------------------------------
----- PROPIEDADES DEL VAPOR DE AGUA SOBRECALENTADO --------------------------------------------------------
-----------------------------------------------------------------------------------------------------------

-- DENSIDAD (kg/m3) de vapor sobrecalentado en función de Temperatura (ºC) y Presión (bar)

--FUNCTION REAL dens_vsobre (REAL T, REAL P)
--DECLS
--	REAL Tsat, Psat
--	REAL d
--	CONST STRING mens_A = "mensajeA ERROR en el cálculo de la DENSIDAD, en esas condiciones de presión y temperatura no existe vapor, es líquido. \
--					Por defecto se toma el valor correspondiente a vapor saturado a esa presión"
--	CONST STRING mens_B = "mensajeB ERROR en el cálculo de la DENSIDAD del vapor sobrecalentado, excedido rango de presión (P <= 80. bar). \
--					Por defecto se toma el valor correspondiente a P máxima"
--
--	TABLE_2D d006_07 = {{0.06, 0.35, 0.7}, \
--		{89.95, 100., 120., 160., 200., 240., 280., 320., 360., 400., 440., 500.}, \
--		{{0.0358, 0.0349, 0.0331, 0.0300, 0.0275, 0.0253, 0.0235, 0.0219, 0.0206, 0.0193, 0.0182, 0.0168}, \
--		 {0.2101, 0.2043, 0.1937, 0.1756, 0.1606, 0.1480, 0.1372, 0.1280, 0.1198, 0.1127, 0.1064, 0.0981}, \
--		 {0.4228, 0.4108, 0.3890, 0.3520, 0.3218, 0.2964, 0.2747, 0.2561, 0.2398, 0.2255, 0.2129, 0.1963}}}
--
--	TABLE_2D d1_3 = {{1.0, 1.5, 3.0},\
--		{133.55, 160., 200., 240., 280., 320., 360., 400., 440., 500.}, \
--		{{0.5383, 0.5040, 0.4604, 0.4239, 0.3928, 0.3660, 0.3428, 0.3223, 0.3041, 0.2805}, \
--		 {0.8119, 0.7593, 0.6925, 0.6369, 0.5900, 0.5498, 0.5147, 0.4838, 0.4564, 0.4174}, \
--		 {1.6502, 1.5361, 1.3966, 1.2804, 1.1848, 1.1025, 1.0320, 0.9690, 0.9141, 0.8425}}} 
--
--	TABLE_2D d5_15 = {{5.0, 7.0, 10.0, 15.0},\
--		{198.32, 240., 280., 320., 360., 400., 440., 500., 540., 600., 640. }, \
--		{{2.3630, 2.1524, 1.9865, 1.8464, 1.7253, 1.6200, 1.5272, 1.4067, 1.3366, 1.2436, 1.1887}, \
--		 {3.3487, 3.0377, 2.7980, 2.5961, 2.4237, 2.2743, 2.1427, 1.9724, 1.8736, 1.7428, 1.6656}, \
--		 {4.8773, 4.3956, 4.0323, 3.7341, 3.4807, 3.2616, 3.0703, 2.8241, 2.6817, 2.4931, 2.3821}, \
--		 {7.5873, 6.7431, 6.1463, 5.6657, 5.2659, 4.9261, 4.6296, 4.2517, 4.0355, 3.7481, 3.5804}}}
--
--	TABLE_2D d20_35 = {{20., 25., 30., 35.}, \
--		{242.6, 264., 280., 320., 360., 400., 440., 500., 540., 600., 640., 700.}, \
--		{{9.1535, 8.6655, 8.3333, 7.6453, 7.0872, 6.6138, 6.2073, 5.6915, 5.3967, 5.0100, 4.7824, 4.4803}, \
--		 {11.3022, 10.5854, 10.1471, 9.2678, 8.5690, 7.9808, 7.4822, 6.8517, 6.4935, 6.0241, 5.7488, 5.3821}, \
--		 {14.5394, 13.5980, 12.9702, 11.7647, 10.8342, 10.0604, 9.4162, 8.6059, 8.1500, 7.5529, 7.2046, 6.7385}, \
--		 {36.9413, 15.8831, 15.0875, 13.6064, 12.4860, 11.5734, 10.8155, 9.8702, 9.3392, 8.6486, 8.2474, 7.7101}}}
--
--	TABLE_2D d40_55= {{40., 45., 50., 55.}, \
--		{270.16, 280., 320., 360., 400., 440., 500., 540., 600., 640., 700.}, \
--		{{18.6686, 18.0310, 16.1316, 14.7319, 13.6221, 12.7033, 11.5701, 10.9349, 10.1163, 9.6432, 9.0090}, \
--		 {21.1210, 20.0481, 17.7999, 16.1970, 14.9477, 13.9198, 12.6614, 11.9232, 11.0558, 10.5352, 9.8396}, \
--		 {24.2032, 22.5657, 19.8511, 17.9872, 16.5563, 15.3917, 13.9782, 13.1926, 12.1877, 11.6083, 10.8389}, \
--		 {28.0584, 25.8114, 22.4379, 20.2214, 18.5546, 17.2132, 15.6018, 14.7113, 13.5777, 12.9253, 12.0642}}}
--
--	TABLE_2D d60_70 = {{60., 65., 70.}, \
--		{285.9, 291.09, 295.06, 320., 360., 400., 440., 480., 520., 560., 600., 640., 700., 740.}, \
--		{{29.4165, 28.8020, 28.3490, 25.7998, 23.0894, 21.1015, 19.5236, 18.2349, 17.1233, 16.1681, 15.3257, 14.5794, 13.6017, 13.0259}, \
--		 {32.6626, 31.7890, 30.9253, 27.9525, 24.8725, 22.6642, 20.9336, 19.5255, 18.3209, 17.2883, 16.3800, 15.5769, 14.5259, 13.9082}, \
--		 {36.5364, 35.4674, 34.0167, 30.4971, 26.9542, 24.4768, 22.5632, 21.0128, 19.6986, 18.5753, 17.5901, 16.7210, 15.5848, 14.9187}}}
--
--	TABLE_2D d75_80 = {{75., 80.}, \
--		{295.06, 320., 360., 400., 440., 480., 520., 560., 600., 640., 700., 740.}, \
--		{{38.3970, 33.5514, 29.4161, 26.6046, 24.4678, 22.7454, 21.3004, 20.0692, 18.9934, 18.0465, 16.8103, 16.0875}, \
--		 {42.5170, 37.2856, 32.3729, 29.1375, 26.7237, 24.7893, 23.1857, 21.8245, 20.6398, 19.6002, 18.2448, 17.4551}}}
--
--BODY
--	Psat = pres_sat_w(T)
--	Tsat = temp_sat_w(P)
----	IF (T < Tsat AND P > Psat) THEN
----		d = linearInterp1D (dens_vsat, P)
----		PRINT (mens_A)
--	IF (T == Tsat AND P == Psat) THEN
--		d = linearInterp1D (dens_vsat, P)
--	ELSE 
--	   IF (P > 0. AND P < 1.) THEN
--		d = linearInterp2D(d006_07, P, T)
--	   ELSEIF (P >= 1. AND P < 4.) THEN
--		d = linearInterp2D(d1_3, P, T)
--	   ELSEIF (P >= 4. AND P < 17.5) THEN
--		d = linearInterp2D(d5_15, P, T)
--	   ELSEIF (P >= 17.5 AND P < 37.5) THEN
--		d = linearInterp2D(d20_35, P, T)
--	   ELSEIF (P >= 37.5 AND P < 57.5) THEN
--		d = linearInterp2D(d40_55, P, T)
--	   ELSEIF (P >= 57.5 AND P <= 72.5) THEN
--		d = linearInterp2D(d60_70, P, T)
--	   ELSEIF (P >= 72.5 AND P <= 80.0) THEN
--		d = linearInterp2D(d75_80, P, T)
--	   ELSE
--		d = linearInterp2D(d75_80, 80., T)
--		PRINT (mens_B)
--	   END IF	
--	END IF
--	
--	RETURN d
--END FUNCTION

---------------------------------------------------------------------------------------
TABLE_2D temp_vsobre_P5_15_H = {{5., 7., 10.,15.}, \
		{2798.9, 2811.8, 2823.7, 2851.8, 2899.3, 2920.4, 2939.9, 2992.7, 3017.1, 3022.9, 3081.9, 3100.9, 3169.2, 3178.9, 3188.4, 3263.9, 3271.9, 3356.0, 3481.7, 3560.9, 3571.0, 3700.2, 3783.8}, \
		{{174.18, 179.91, 185.39, 198.32, 220.80, 230.78, 240.00, 265.45, 277.20, 280.00, 308.54, 317.73, 350.72, 355.41, 360.00, 396.17, 400.00, 440.00, 498.97, 535.35, 540.00, 599.31, 636.62}, \
		 {179.91, 185.55, 190.75, 203.23, 224.96, 234.61, 243.63, 268.50, 280.00, 282.77, 310.93, 320.00, 352.60, 357.23, 361.76, 397.71, 401.51, 441.26, 500.00, 536.25, 540.88, 600.00, 634.47}, \
		 {188.31, 193.51, 198.32, 210.41, 230.91, 240.00, 248.88, 272.94, 284.15, 286.86, 314.40, 323.29, 355.44, 360.00, 364.47, 400.00, 403.75, 443.11, 501.47, 537.89, 542.50, 601.03, 638.48}, \
		 {200.93, 205.95, 210.58, 221.50, 240.00, 249.04, 257.39, 280.00, 290.94, 293.54, 320.00, 328.71, 360.00, 364.48, 368.87, 403.74, 407.43, 446.20, 503.92, 540.00, 544.56, 602.76, 640.00}}}


TABLE_2D temp_vsobre_P5_15_S = {{5.0, 7.0, 10.0, 15.0},\
		{6.821, 6.838, 6.878, 6.889, 6.965, 6.994, 7.047, 7.064, 7.136, 7.196, 7.223, 7.231, 7.269, 7.335, 7.370, 7.387, \
		 7.394, 7.465, 7.506, 7.531, 7.570, 7.588, 7.635, 7.666, 7.681, 7.757, 7.762, 7.794, 7.839, 7.872, 7.915, 7.939}, \
		{{151.860, 155.136, 162.961, 165.000, 179.910, 186.031, 197.287, 201.286, 218.063, 231.983, 238.280, 240.000, 249.833, 266.752, 275.687, 280.000, \
		  282.079, 301.788, 313.209, 320.000, 331.538, 337.012, 350.828, 360.000, 364.538, 388.513, 390.110, 400.000, 414.728, 425.766, 440.000, 448.332}, \
		 {186.766, 190.176, 198.320, 200.664, 217.809, 224.236, 236.053, 240.000, 258.141, 273.191, 280.000, 282.022, 292.486, 310.492, 320.000, 324.919, \
		  327.116, 347.936, 360.000, 367.615, 379.736, 385.486, 400.000, 410.156, 414.906, 440.000, 441.771, 452.743, 468.264, 479.896, 494.896, 503.463}, \
		 {227.201, 230.761, 239.264, 241.694, 260.252, 267.209, 280.000, 284.703, 303.995, 320.000, 327.815, 329.950, 340.995, 360.000, 370.691, 375.853, \
		  378.157, 400.000, 413.377, 421.331, 433.994, 440.000, 456.113, 466.809, 471.811, 498.240, 500.000, 511.512, 527.796, 540.000, 556.510, 565.643}, \
		 {276.167, 280.000, 290.309, 292.994, 312.637, 320.000, 334.793, 339.733, 360.000, 378.056, 386.225, 388.455, 400.000, 421.088, 432.224, 437.600, \
		  440.000, 464.266, 478.328, 486.689, 500.000, 506.685, 523.559, 534.761, 540.000, 569.089, 571.025, 583.025, 600.000, 613.320, 630.497, 640.000}}}

---------------------------------------------------------------------------------------
FUNCTION REAL dens_vsobre (REAL T, REAL P)
DECLS
	REAL Tsat
	REAL d
--	CONST STRING mens_A = "mensajeA ERROR en el cálculo de la DENSIDAD, en esas condiciones de presión y temperatura no existe vapor, es líquido. \
--					Por defecto se toma el valor correspondiente a vapor saturado a esa presión"
--	CONST STRING mens_B = "mensajeB ERROR en el cálculo de la DENSIDAD del vapor sobrecalentado, excedido rango de presión (P <= 70. bar). \
--					Por defecto se toma el valor correspondiente a Pmáxima (70 bar)"
--	CONST STRING mens_C = "mensajeC ERROR en el cálculo de la DENSIDAD del vapor sobrecalentado: excedido rango de presión -> se toma P=70 bar; \
--					a 70 bar y esa temperatura no existe vapor -> se toma el vapor de saturación a 70 bares"

	TABLE_2D d05_70 = {{0.5, 1.0, 3.0, 5.0, 7.0, 10.0, 15.0, 20.0, 25.0, 30.0, 35.0, 40.0, 45.0, 50.0, 55.0, 60.0, 65.0, 70.0}, \
		{81.317, 99.606, 115.0, 133.522, 151.831, 164.946, 179.878, 198.287, 212.377, 223.95, 233.853, 242.557, 250.354, \
		 257.437, 263.941, 269.965, 275.585, 280.858, 285.829, 300.0, 320.0, 340.0, 360.0, 380.0, 400.0, 420.0, \
		 440.0, 460.0, 480.0, 500.0, 520.0, 540.0, 560.0, 580.0, 600.0, 620.0, 640.0}, \

		{{0.3086, 0.2928, 0.2808, 0.2677, 0.2560, 0.2482, 0.2399, 0.2304, 0.2237, 0.2184, 0.2141, 0.2105, 0.2073, \
		  0.2045, 0.2020, 0.1998, 0.1977, 0.1958, 0.1941, 0.1892, 0.1828, 0.1769, 0.1713, 0.1660, 0.1610, 0.1564, \
		  0.1520, 0.1478, 0.1439, 0.1402, 0.1366, 0.1333, 0.1301, 0.1270, 0.1241, 0.1213, 0.1187}, \

		 {0.5903, 0.5903, 0.5653, 0.5382, 0.5140, 0.4981, 0.4813, 0.4620, 0.4483, 0.4377, 0.4290, 0.4217, 0.4153, \
		  0.4097, 0.4047, 0.4001, 0.3960, 0.3922, 0.3887, 0.3790, 0.3661, 0.3540, 0.3428, 0.3322, 0.3223, 0.3130, \
		  0.3041, 0.2958, 0.2879, 0.2805, 0.2734, 0.2666, 0.2602, 0.2541, 0.2483, 0.2427, 0.2374}, \

		 {1.6508, 1.6508, 1.6508, 1.6508, 1.5696, 1.5174, 1.4627, 1.4001, 1.3550, 1.3246, 1.2974, 1.2745, 1.2547, \
		  1.2365, 1.2217, 1.2077, 1.1949, 1.1831, 1.1723, 1.1424, 1.1029, 1.0661, 1.0317, 0.9996, 0.9694, 0.9411, \
		  0.9143, 0.8891, 0.8653, 0.8427, 0.8212, 0.8009, 0.7815, 0.7631, 0.7455, 0.7287, 0.7127}, \

		 {2.6681, 2.6681, 2.6681, 2.6681, 2.6681, 2.5711, 2.4720, 2.3624, 2.2861, 2.2277, 2.1803, 2.1405, 2.1091, \
		  2.0762, 2.0494, 2.0252, 2.0033, 1.9831, 1.9645, 1.9135, 1.8461, 1.7836, 1.7253, 1.6709, 1.6200, 1.5721, \
		  1.5271, 1.4846, 1.4445, 1.4066, 1.3706, 1.3365, 1.3040, 1.2731, 1.2437, 1.2155, 1.1887}, \

		 {3.6660, 3.6660, 3.6660, 3.6660, 3.6660, 3.6660, 3.5129, 3.3427, 3.2343, 3.1481, 3.0787, 3.0206, 2.9702, \
		  2.9271, 2.8881, 2.8533, 2.8216, 2.7925, 2.7657, 2.6924, 2.5959, 2.5066, 2.4236, 2.3463, 2.2739, 2.2061, \
		  2.1424, 2.0824, 2.0258, 1.9722, 1.9215, 1.8734, 1.8277, 1.7842, 1.7427, 1.7032, 1.6655}, \

		 {5.1450, 5.1450, 5.1450, 5.1450, 5.1450, 5.1450, 5.1450, 4.8766, 4.6980, 4.5653, 4.4575, 4.3689, 4.2932, \
		  4.2271, 4.1686, 4.1162, 4.0686, 4.0252, 3.9852, 3.8762, 3.7333, 3.6018, 3.4801, 3.3670, 3.2615, 3.1629, \
		  3.0704, 2.9834, 2.9014, 2.8240, 2.7507, 2.6813, 2.6154, 2.5527, 2.4931, 2.4362, 2.3820}, \

		 {7.5924, 7.5924, 7.5924, 7.5924, 7.5924, 7.5924, 7.5924, 7.5924, 7.2671, 7.0346, 6.8478, 6.6996, 6.5729, \
		  6.4633, 6.3668, 6.2808, 6.2033, 6.1327, 6.0680, 5.8925, 5.6648, 5.4569, 5.2659, 5.0894, 4.9256, 4.7730, \
		  4.6303, 4.4966, 4.3709, 4.2524, 4.1405, 4.0346, 3.9343, 3.8390, 3.7484, 3.6621, 3.5799}, \

		 {10.0417, 10.0417, 10.0417, 10.0417, 10.0417, 10.0417, 10.0417, 10.0417, 10.0417, 9.6645, 9.3798, 9.1512, 8.9605, \
		  8.7973,  8.6550,  8.5288,  8.4157,  8.3132,  8.2197,  7.9677,  7.6440,  7.3514,  7.0845, 6.8394, 6.6131, 6.4032, \
		  6.2076,  6.0247,  5.8533,  5.6921,  5.5401,  5.3966,  5.2608,  5.1320,  5.0097,  4.8933, 4.7824}, \

		 {12.5080, 12.5080, 12.5080, 12.5080, 12.5080, 12.5080, 12.5080, 12.5080, 12.5080, 12.5080, 12.0805, 11.7477, 11.4753, \
		  11.2451, 11.0463, 10.8715, 10.7158, 10.5755, 10.4481, 10.1075, 9.6749,  9.2879,  8.9378,  8.6184,  8.3251,  8.0541, \
		  7.8025,  7.5681,  7.3489,  7.1433,  6.9498,  6.7674,  6.5950,  6.4318,  6.3769,  6.1298,  5.9897}, \

		 {15.0005, 15.0005, 15.0005, 15.0005, 15.0005, 15.0005, 15.0005, 15.0005, 15.0005, 15.0005, 15.0005, 14.4717, 14.1424, \
		  13.8267, 13.5574, 13.3229, 13.1156, 12.9302, 12.7625, 12.3185, 11.7617, 11.2693, 10.8278, 10.4278, 10.0625, 9.7265, \
		  9.4159,  9.1273,  8.8581,  8.6062,  8.3697,  8.1471,  7.9371,  7.7385,  7.5503,  7.3716,  7.2017}, \

		 {17.5261, 17.5261, 17.5261, 17.5261, 17.5261, 17.5261, 17.5261, 17.5261, 17.5261, 17.5261, 17.5261, 17.5261, 16.9967, \
		  16.5686, 16.3094, 15.9005, 15.6301, 15.3899, 15.1742, 14.6085, 13.9094, 13.2989, 12.7567, 12.2692, 11.8256, 11.4213, \
		  11.0481, 10.7026, 10.3812, 10.0812, 9.8001,  9.5360,  9.2871,  9.0521,  8.8297,  8.6189,  8.4185}, \

		 {20.0900, 20.0900, 20.0900, 20.0900, 20.0900, 20.0900, 20.0900, 20.0900, 20.0900, 20.0900, 20.0900, 20.0900, 20.0900, \
		  19.5073, 19.0303, 18.6267, 18.2775, 17.9703, 17.6965, 16.9867, 16.1235, 15.3802, 14.7270, 14.1441, 13.6182, 13.1392, \
		  12.6999, 12.2946, 11.9186, 11.5685, 11.2411, 10.9341, 10.6453, 10.3729, 10.1155, 9.8716,  9.6402}, \

		 {22.6969, 22.6969, 22.6969, 22.6969, 22.6969, 22.6969, 22.6969, 22.6969, 22.6969, 22.6969, 22.6969, 22.6969, 22.6969, \
		  22.6969, 22.0586, 21.5311, 21.0817, 20.6910, 20.3460, 19.4637, 18.4104, 17.5173, 16.7411, 16.0545, 15.4389, 14.8813, \
		  14.3720, 13.9036, 13.4706, 13.0683, 12.6930, 12.3416, 12.0116, 11.7009, 11.4075, 11.1299, 10.8667}, \

		 {25.3512, 25.3512, 25.3512, 25.3512, 25.3512, 25.3512, 25.3512, 25.3512, 25.3512, 25.3512, 25.3512, 25.3512, 25.3512, \
		  25.3512, 25.3512, 24.6544, 24.0741, 23.5773, 23.1437, 22.0525, 20.7773, 19.7145, 18.8020, 18.0021, 17.2899, 16.6483, \
		  16.0647, 15.5303, 15.0376, 14.5809, 14.1559, 13.7587, 13.3863, 13.0361, 12.7059, 12.3938, 12.0982}, \

		 {28.0570, 28.0570, 28.0570, 28.0570, 28.0570, 28.0570, 28.0570, 28.0570, 28.0570, 28.0570, 28.0570, 28.0570, 28.0570, \
		  28.0570, 28.0570, 28.0570, 27.2983, 26.6627, 26.1163, 24.7689, 23.2327, 21.9769, 20.9129, 19.9890, 19.1726, 18.4412, \
		  17.7793, 17.1751, 16.6199, 16.1067, 15.6300, 15.1855, 14.7694, 14.3787, 14.0107, 13.6634, 13.3347}, \

		 {30.8184, 30.8184, 30.8184, 30.8184, 30.8184, 30.8184, 30.8184, 30.8184, 30.8184, 30.8184, 30.8184, 30.8184, 30.8184, \
		  30.8184, 30.8184, 30.8184, 30.8184, 29.9939, 29.3001, 27.6325, 25.7865, 24.3100, 23.0770, 22.0175, 21.0884, 20.2612, \
		  19.5160, 18.8385, 18.2179, 17.6458, 17.1157, 16.6222, 16.1611, 15.7287, 15.3221, 14.9386, 14.5762}, \

		 {33.6397, 33.6397, 33.6397, 33.6397, 33.6397, 33.6397, 33.6397, 33.6397, 33.6397, 33.6397, 33.6397, 33.6397, 33.6397, \
		  33.6397, 33.6397, 33.6397, 33.6397, 33.6397, 32.7449, 30.6678, 28.4503, 26.7203, 25.2983, 24.0900, 23.0391, 22.1903, \
		  21.2758, 20.5211, 19.8321, 19.1986, 18.6130, 18.0690, 17.5615, 17.0863, 16.6400, 16.2197, 15.8227}, \

		 {36.5251, 36.5251, 36.5251, 36.5251, 36.5251, 36.5251, 36.5251, 36.5251, 36.5251, 36.5251, 36.5251, 36.5251, 36.5251, \
		  36.5251, 36.5251, 36.5251, 36.5251, 36.5251, 36.5251, 33.9071, 32.2382, 29.2150, 27.5810, 26.2091, 25.0262, 23.9866, \
		  23.0595, 22.2235, 21.4628, 20.7654, 20.1223, 19.5260, 18.9707, 18.4516, 17.9647, 17.5066, 17.0744}}}

BODY
	Tsat = temp_sat_w(P)
	IF (P > 0. AND P <= 70) THEN
		d = linearInterp2D(d05_70, P, T)
--		IF (T < Tsat-0.1) THEN
--			PRINT (mens_A)
--		END IF
	ELSE
		d = linearInterp2D(d05_70, 70., T)
--		PRINT (mens_B)
--		IF (T < temp_sat_w(70)-0.1) THEN
--			PRINT (mens_C)
--		END IF
	END IF	
	RETURN d
END FUNCTION

----------------------------------------------------------------------------------------
-- ENTALPÍA ESPECÍFICA (kJ/kg) de vapor sobrecalentado  en función de Temperatura (ºC) y Presión (bar)

--FUNCTION REAL entalp_vsobre (REAL T, REAL P)
--DECLS
--	REAL Psat, Tsat	
--	REAL h
--	CONST STRING mens_A = "mensajeA: ERROR en el cálculo de la ENTALPÍA ESPECÍFICA, en esas condiciones de presión y temperatura no existe vapor, es líquido. \
--					Por defecto se toma el valor correspondiente a vapor saturado a esa presión"
--	CONST STRING mens_B = "mensajeB ERROR en el cálculo de la ENTALPÍA ESPECÍFICA del vapor sobrecalentado, excedido rango de presión (P <= 80. bar). \
--					Por defecto se toma el valor correspondiente a P máxima"
--
--	TABLE_2D h006_07 = {{0.06, 0.35, 0.7}, \
--		{89.95, 100., 120., 160., 200., 240., 280., 320., 360., 400., 440., 500.}, \
--		{{2669.0, 2688.1, 2726.0, 2802.5, 2879.7, 2957.8, 3036.8, 3116.7, 3197.7, 3279.6, 3362.6, 3489.1}, \
--		 {2664.9, 2684.4, 2723.1, 2800.6, 2878.4, 2956.8, 3036.0, 3116.1, 3197.1, 3279.2, 3362.2, 3488.8}, \
--		 {2660.0, 2680.0, 2719.6, 2798.2, 2876.7, 2955.5, 3035.0, 3115.3, 3196.5, 3278.6, 3361.8, 3488.5}}}
--
--	TABLE_2D h1_3 = {{1.0, 1.5, 3.0},\
--		{133.55, 160., 200., 240., 280., 320., 360., 400., 440., 500.}, \
--		{{2743.6, 2796.2, 2875.3, 2954.5, 3034.2, 3114.6, 3195.9, 3278.2, 3361.4, 3488.1 }, \
--		 {2739.0, 2792.8, 2872.9, 2952.7, 3032.8, 3113.5, 3195.0, 3277.4, 3360.7, 3487.6 }, \
--		 {2725.3, 2782.3, 2865.5, 2947.3, 3028.6, 3110.1, 3192.2, 3275.0, 3358.7, 3486.0 }}} 
--
--	TABLE_2D h5_15 = {{5.0, 7.0, 10.0, 15.0},\
--		{198.32, 240., 280., 320., 360., 400., 440., 500., 540., 600., 640. }, \
--		{{2851.8, 2939.9, 3022.9, 3105.6, 3188.4, 3271.9, 3356.0, 3483.9, 3571.0, 3701.7, 3791.4}, \
--		 {2841.0, 2932.2, 3017.1, 3100.9, 3184.7, 3268.7, 3353.3, 3481.7, 3569.1, 3700.2, 3797.2}, \
--		 {2823.7, 2920.4, 3008.2, 3093.9, 3178.9, 3263.9, 3349.3, 3478.5, 3565.6, 3697.9, 3787.2}, \
--		 {2792.2, 2899.3, 2992.7, 3081.9, 3169.2, 3255.8, 3342.5, 3473.1, 3560.9, 3694.0, 3783.8}}}
--
--	TABLE_2D h20_35 = {{20., 25., 30., 35.}, \
--		{242.6, 264., 280., 320., 360., 400., 440., 500., 540., 600., 640., 700.}, \
--		{{2887.3, 2976.4, 2976.4, 3069.5, 3159.3, 3247.6, 3335.5, 3467.6, 3556.1, 3690.1, 3780.4, 3917.4}, \
--		 {2852.1, 2935.5, 2958.9, 3056.5, 3149.0, 3239.3, 3328.5, 3462.1, 3551.4, 3686.2, 3777.0, 3914.6}, \
--		 {2831.9, 2894.5, 2941.3, 3043.4, 3138.7, 3230.9, 3321.5, 3456.5, 3546.6, 3682.3, 3773.5, 3911.7}, \
--		 {2803.4, 2871.0, 2921.6, 3029.4, 3128.0, 3222.3, 3314.3, 3450.9, 3541.8, 3678.4, 3770.1, 3908.8}}}
--
--	TABLE_2D h40_55= {{40., 45., 50., 55.}, \
--		{270.16, 280., 320., 360., 400., 440., 500., 540., 600., 640., 700.}, \
--		{{2868.4, 2901.8, 3015.4, 3117.2, 3213.6, 3307.1, 3445.3, 3536.9, 3674.4, 3766.6, 3905.9}, \
--		 {2842.8, 2877.4, 2999.7, 3105.7, 3204.5, 3299.7, 3439.5, 3531.9, 3670.4, 3763.1, 3903.0}, \
--		 {2816.9, 2853.0, 2984.0, 3067.2, 3195.4, 3292.2, 3433.8, 3527.0, 3666.4, 3759.6, 3900.0}, \
--		 {2789.7, 2828.6, 2968.3, 3069.2, 3186.3, 3284.8, 3428.0, 3522.0, 3662.4, 3756.1, 3897.1}}}
--
--	TABLE_2D h60_70 = {{60., 65., 70.}, \
--		{285.9, 291.09, 295.06, 320., 360., 400., 440., 480., 520., 560., 600., 640., 700., 740.}, \
--		{{2826.1, 2845.3, 2860.1, 2952.6, 3071.1, 3177.2, 3277.3, 3373.9, 3469.6, 3564.1, 3658.4, 3752.6, 3894.1, 3989.2}, \
--		 {2783.2, 2819.6, 2834.6, 2933.8, 3058.3, 3167.5, 3269.5, 3367.5, 3464.1, 3559.4, 3654.3, 3749.0, 3891.2, 3986.6}, \
--		 {2772.1, 2793.8, 2809.0, 2914.9, 3045.5, 3157.8, 3261.7, 3361.2, 3458.7, 3554.7, 3650.2, 3745.5, 3888.3, 3984.0}}}
--
--	TABLE_2D h75_80 = {{75., 80.}, \
--		{295.06, 320., 360., 400., 440., 480., 520., 560., 600., 640., 700., 740.}, \
--		{{2783.0, 2896.1, 3032.6, 3148.0, 3253.9, 3354.8, 3453.2, 3550.0, 3646.1, 3741.9, 3885.3, 3981.3}, \
--		 {2758.0, 2877.2, 3019.8, 3138.3, 3246.1, 3348.4, 3447.7, 3545.3, 3642.0, 3738.3, 3882.4, 3978.7}}}
--
--BODY
--	Psat = pres_sat_w(T)
--	Tsat = temp_sat_w(P)
----	IF (T < Tsat AND P > Psat) THEN
----		h = entalp_vsat_T(T)
----		PRINT (mens_A)
--	IF (T == Tsat AND P == Psat) THEN
--		h = entalp_vsat_T(T)
--	ELSE 
--	   IF (P > 0. AND P < 1.) THEN
--		h = linearInterp2D(h006_07, P, T)
--	   ELSEIF (P >= 1. AND P < 4.) THEN
--		h = linearInterp2D(h1_3, P, T)
--	   ELSEIF (P >= 4. AND P < 17.5) THEN
--		h = linearInterp2D(h5_15, P, T)
--	   ELSEIF (P >= 17.5 AND P < 37.5) THEN
--		h = linearInterp2D(h20_35, P, T)
--	   ELSEIF (P >= 37.5 AND P < 57.5) THEN
--		h = linearInterp2D(h40_55, P, T)
--	   ELSEIF (P >= 57.5 AND P <= 72.5) THEN
--		h = linearInterp2D(h60_70, P, T)
--	   ELSEIF (P >= 72.5 AND P <= 80.0) THEN
--		h = linearInterp2D(h75_80, P, T)
--	   ELSE
--		h = linearInterp2D(h75_80, 80., T)
--		PRINT (mens_B)
--	   END IF	
--	END IF
--	RETURN h
--END FUNCTION

----------------------------------------------------------------------------------------
-- ENTALPÍA ESPECÍFICA (kJ/kg) de vapor sobrecalentado  en función de Temperatura (ºC) y Presión (bar)

FUNCTION REAL entalp_vsobre (REAL T, REAL P)
DECLS
	REAL Tsat	
	REAL h
--	CONST STRING mens_A = "mensajeA ERROR en el cálculo de la ENTALPÍA, en esas condiciones de presión y temperatura no existe vapor, es líquido. \
--					Por defecto se toma el valor correspondiente a vapor saturado a esa presión"
--	CONST STRING mens_B = "mensajeB ERROR en el cálculo de la ENTALPÍA del vapor sobrecalentado, excedido rango de presión (P <= 70. bar). \
--					Por defecto se toma el valor correspondiente a Pmáxima (70 bar)"
--	CONST STRING mens_C = "mensajeC ERROR en el cálculo de la ENTALPÍA del vapor sobrecalentado: excedido rango de presión -> se toma P=70 bar; \
--					a 70 bar y esa temperatura no existe vapor -> se toma el vapor de saturación a 70 bares"

	TABLE_2D h05_70 = {{0.5, 1.0, 3.0, 5.0, 7.0, 10.0, 15.0, 20.0, 25.0, 30.0, 35.0, 40.0, 45.0, 50.0, 55.0, 60.0, 65.0, 70.0}, \
		{81.317, 99.606, 115.0, 133.522, 151.831, 164.946, 179.878, 198.287, 212.377, 223.95, 233.853, 242.557, 250.354, \
		 257.437, 263.941, 269.965, 275.585, 280.858, 285.829, 300.0, 320.0, 340.0, 360.0, 380.0, 400.0, 420.0, \
		 440.0, 460.0, 480.0, 500.0, 520.0, 540.0, 560.0, 580.0, 600.0, 620.0, 640.0}, \

		{{2645.22, 2681.65, 2711.91, 2748.10, 2783.78, 2809.33, 2838.44, 2874.41, 2902.02, 2924.76, 2944.26, 2961.43, 2976.85, \
		  2990.88, 3003.79, 3015.76, 3026.95, 3037.46, 3047.39, 3075.76, 3115.99, 3156.56, 3197.17, 3238.16, 3279.33, 3320.79, \
		  3362.52, 3404.50, 3446.75, 3489.27, 3532.05, 3575.12, 3618.45, 3662.07, 3705.96, 3750.14, 3794.60}, \

		 {2674.95, 2674.95, 2706.52, 2743.79, 2780.24, 2803.21, 2835.71, 2872.07, 2899.91, 2922.81, 2942.63, 2959.72, 2975.22, \
		  2989.32, 3002.29, 3014.31, 3025.55, 3036.10, 3046.07, 3074.53, 3114.89, 3155.46, 3196.25, 3237.29, 3278.56, 3320.08, \
		  3361.86, 3403.89, 3446.18, 3488.73, 3531.56, 3574.65, 3618.02, 3661.66, 3705.58, 3749.77, 3794.25}, \

		 {2724.88, 2724.88, 2724.88, 2724.88, 2765.13, 2793.07, 2824.33, 2862.37, 2893.29, 2914.87, 2935.03, 2952.74, 2968.58, \
		  2983.59, 2996.20, 3008.44, 3019.87, 3030.60, 3040.71, 3069.58, 3110.43, 3151.42, 3192.57, 3233.92, 3275.47, 3317.23, \
		  3359.21, 3401.43, 3443.90, 3486.60, 3529.57, 3572.79, 3616.27, 3660.01, 3704.03, 3748.31, 3792.87}, \

		 {2748.11, 2748.11, 2748.11, 2748.11, 2748.11, 2778.74, 2812.16, 2852.16, 2882.20, 2906.62, 2927.38, 2945.55, 2961.94, \
		  2976.48, 2989.97, 3002.44, 3014.07, 3024.98, 3035.26, 3064.55, 3105.91, 3147.33, 3188.86, 3230.52, 3272.35, 3314.36, \
		  3356.56, 3398.97, 3441.61, 3484.47, 3527.57, 3570.92, 3614.51, 3658.36, 3702.47, 3745.84, 3791.48}, \

		 {2762.75, 2762.75, 2762.75, 2762.75, 2762.75, 2762.75, 2799.09, 2842.73, 2872.76, 2898.06, 2919.47, 2938.14, 2954.95, \
		  2969.82, 2983.64, 2996.31, 3008.16, 3019.26, 3029.71, 3059.45, 3101.34, 3143.20, 3185.11, 3227.10, 3269.21, 3311.47, \
		  3353.89, 3396.50, 3439.31, 3482.33, 3525.57, 3569.04, 3612.75, 3656.71, 3700.91, 3745.38, 3790.10}, \

		 {2777.11, 2777.11, 2777.11, 2777.11, 2777.11, 2777.11, 2777.11, 2824.09, 2857.78, 2884.37, 2907.09, 2926.60, 2943.90, \
		  2959.50, 2973.74, 2986.87, 2999.06, 3010.47, 3021.19, 3051.63, 3094.36, 3136.93, 3179.46, 3221.93, 3264.47, 3307.11, \
		  3349.87, 3392.77, 3435.84, 3479.10, 3522.56, 3566.22, 3610.11, 3654.22, 3698.58, 3743.17, 3788.01}, \

		 {2790.96, 2790.96, 2790.96, 2790.96, 2790.96, 2790.96, 2790.96, 2790.96, 2830.26, 2860.03, 2885.23, 2906.15, 2924.75, \
		  2941.41, 2956.53, 2970.40, 2983.25, 2995.22, 3006.45, 3038.19, 3082.43, 3126.25, 3169.79, 3213.17, 3256.47, 3299.77, \
		  3343.10, 3386.51, 3430.03, 3473.69, 3517.51, 3561.50, 3605.68, 3650.07, 3694.66, 3739.48, 3784.53}, \

		 {2798.29, 2798.29, 2798.29, 2798.29, 2798.29, 2798.29, 2798.29, 2798.29, 2798.29, 2833.13, 2860.74, 2883.97, 2904.14, \
		  2922.06, 2938.22, 2952.97, 2966.57, 2979.20, 2991.00, 3024.18, 3070.11, 3115.27, 3159.93, 3204.24, 3248.34, 3292.32, \
		  3336.25, 3380.19, 3424.17, 3468.24, 3512.43, 3556.75, 3601.23, 3645.89, 3690.74, 3735.78, 3781.04}, \

		 {2801.93, 2801.93, 2801.93, 2801.93, 2801.93, 2801.93, 2801.93, 2801.93, 2801.93, 2801.93, 2833.81, 2859.74, 2881.88, \
		  2901.31, 2918.70, 2934.47, 2948.93, 2962.31, 2974.77, 3009.58, 3057.35, 3103.99, 3149.84, 3195.15, 3240.08, 3284.78, \
		  3329.32, 3373.80, 3418.26, 3462.75, 3507.31, 3551.97, 3596.76, 3641.69, 3686.79, 3732.07, 3777.54}, \

		 {2803.15, 2803.15, 2803.15, 2803.15, 2803.15, 2803.15, 2803.15, 2803.15, 2803.15, 2803.15, 2803.15, 2836.20, 2857.62, \
		  2878.94, 2897.80, 2914.78, 2930.25, 2944.48, 2957.68, 2994.33, 3044.15, 3092.38, 3139.51, 3185.87, 3231.69, 3277.13, \
		  3322.31, 3367.34, 3412.29, 3457.22, 3502.16, 3547.17, 3592.26, 3637.48, 3682.83, 3728.34, 3774.03}, \

		 {2802.64, 2802.64, 2802.64, 2802.64, 2802.64, 2802.64, 2802.64, 2802.64, 2802.64, 2802.64, 2802.64, 2802.64, 2830.89, \
		  2854.63, 2875.31, 2893.72, 2910.38, 2925.61, 2939.67, 2978.39, 3030.47, 3080.44, 3128.94, 3176.41, 3223.15, 3269.37, \
		  3315.22, 3360.82, 3406.27, 3451.64, 3496.98, 3542.33, 3587.75, 3633.25, 3678.86, 3724.60, 3770.50}, \

		 {2800.82, 2800.82, 2800.82, 2800.82, 2800.82, 2800.82, 2800.82, 2800.82, 2800.82, 2800.82, 2800.82, 2800.82, 2800.82, \
		  2827.90, 2850.91, 2871.09, 2889.16, 2905.56, 2920.61, 2961.69, 3016.29, 3068.14, 3118.11, 3166.77, 3214.47, 3261.50, \
		  3308.04, 3354.24, 3400.20, 3446.02, 3491.76, 3537.47, 3583.21, 3628.99, 3674.87, 3720.85, 3766.97}, \

		 {2797.95, 2797.95, 2797.95, 2797.95, 2797.95, 2797.95, 2797.95, 2797.95, 2797.95, 2797.95, 2797.95, 2797.95, 2797.95, \
		  2797.95, 2824.13, 2846.57, 2866.37, 2884.17, 2900.37, 2944.16, 3001.55, 3055.46, 3107.02, 3156.92, 3205.65, 3253.52, \
		  3300.77, 3347.58, 3394.08, 3440.36, 3486.51, 3532.58, 3578.64, 3624.72, 3670.86, 3717.09, 3763.42}, \

		 {2794.21, 2794.21, 2794.21, 2794.21, 2794.21, 2794.21, 2794.21, 2794.21, 2794.21, 2794.21, 2794.21, 2794.21, 2794.21, \
		  2794.21, 2794.21, 2819.69, 2841.69, 2861.20, 2878.79, 2925.70, 2986.23, 3042.39, 3095.64, 3146.88, 3196.67, 3245.43, \
		  3293.42, 3340.86, 3387.90, 3434.66, 3481.22, 3527.67, 3574.06, 3620.43, 3666.84, 3713.31, 3759.87}, \

		 {2789.72, 2789.72, 2789.72, 2789.72, 2789.72, 2789.72, 2789.72, 2789.72, 2789.72, 2789.72, 2789.72, 2789.72, 2789.72, \
		  2789.72, 2789.72, 2789.72, 2814.67, 2836.34, 2855.62, 2906.21, 2970.27, 3028.89, 3083.97, 3136.62, 3187.54, 3237.22, \
		  3285.98, 3334.07, 3381.67, 3428.91, 3475.90, 3522.72, 3569.45, 3616.12, 3662.80, 3709.52, 3756.30}, \

		 {2784.59, 2784.59, 2784.59, 2784.59, 2784.59, 2784.59, 2784.59, 2784.59, 2784.59, 2784.59, 2784.59, 2784.59, 2784.59, \
		  2784.59, 2784.59, 2784.59, 2784.59, 2809.14, 2830.56, 2885.54, 2953.61, 3014.94, 3071.99, 3126.14, 3178.25, 3228.88, \
		  3278.44, 3327.20, 3375.38, 3423.11, 3470.54, 3517.75, 3564.81, 3611.80, 3658.75, 3705.71, 3752.72}, \

		 {2778.88, 2778.88, 2778.88, 2778.88, 2778.88, 2778.88, 2778.88, 2778.88, 2778.88, 2778.88, 2778.88, 2778.88, 2778.88, \
		  2778.88, 2778.88, 2778.88, 2778.88, 2778.88, 2803.13, 2863.52, 2936.19, 3000.51, 3059.59, 3115.43, 3168.79, 3220.43, \
		  3270.81, 3320.27, 3369.03, 3417.28, 3465.15, 3512.74, 3560.15, 3607.45, 3654.68, 3701.89, 3749.13}, \

		 {2772.63, 2772.63, 2772.63, 2772.63, 2772.63, 2772.63, 2772.63, 2772.63, 2772.63, 2772.63, 2772.63, 2772.63, 2772.63, \
		  2772.63, 2772.63, 2772.63, 2772.63, 2772.63, 2772.63, 2839.91, 2917.92, 2985.56, 3047.04, 3104.49, 3159.16, 3211.85, \
		  3263.09, 3313.26, 3362.63, 3411.39, 3459.72, 3507.71, 3555.47, 3603.08, 3650.59, 3698.06, 3745.53}}}

BODY
	Tsat = temp_sat_w(P)
	IF (P > 0. AND P <= 70) THEN
		h = linearInterp2D(h05_70, P, T)
--		IF (T < Tsat-0.1) THEN
--			PRINT (mens_A)
--		END IF
	ELSE
		h = linearInterp2D(h05_70, 70., T)
--		PRINT (mens_B)
--		IF (T < temp_sat_w(70)-0.1) THEN
--			PRINT (mens_C)
--		END IF
	END IF	
	RETURN h
END FUNCTION







-----------------------------------------------------------------------------------
-- CALOR ESPECÍFICO (KJ/kgºC) de vapor sobrecalentado  en función de Temperatura (ºC) y Presión (bar). 

FUNCTION REAL cesp_vsobre (REAL T, REAL P)
DECLS
	REAL Tsat, Psat
	REAL cp
	CONST STRING mens_A = "mensajeA ERROR en el cálculo del CALOR ESPECÍFICO, en esas condiciones de presión y temperatura no existe vapor, es líquido. \
					Por defecto se toma el valor correspondiente a vapor saturado a esa presión"
	CONST STRING mens_B = "mensajeB ERROR en el cálculo del CALOR ESPECÍFICO del vapor sobrecalentado, excedido rango de presión (P <= 80. bar). \
					Por defecto se toma el valor correspondiente a P máxima"


	TABLE_2D cp1_5 = {{1.0, 3.0, 5.0},\
		{151.84, 167.71, 179.88, 200., 250., 300., 350., 400., 450., 500., 550., 600., 650.}, \
		{{1.987, 1.984, 1.982, 1.979, 1.990, 2.010, 2.037, 2.067, 2.099, 2.132, 2.166, 2.201, 2.235}, \
		 {2.152, 2.129, 2.107, 2.070, 2.039, 2.038, 2.054, 2.079, 2.108, 2.139, 2.172, 2.206, 2.239}, \
		 {2.329, 2.277, 2.231, 2.161, 2.088, 2.066, 2.071, 2.090, 2.116, 2.146, 2.177, 2.210, 2.243}}} 

	TABLE_2D cp7_15 = {{7.0, 10.0, 15.0},\
		{198.29, 200., 212.37, 250, 300., 350., 400., 450., 500., 550., 600., 650.}, \
		{{2.313, 2.304, 2.268, 2.161, 2.106, 2.095, 2.105, 2.127, 2.154, 2.184, 2.216, 2.248}, \
		 {2.459, 2.446, 2.393, 2.233, 2.145, 2.118, 2.120, 2.138, 2.162, 2.191, 2.221, 2.253}, \
		 {2.820, 2.800, 2.703, 2.406, 2.235, 2.169, 2.152, 2.160, 2.179, 2.205, 2.233, 2.262}}} 

	TABLE_2D cp20_30 = {{20., 25., 30.},\
		{233.77, 243.52, 250., 300., 350., 400., 450., 500., 550., 600., 650.}, \
		{{2.788, 2.680, 2.608, 2.337, 2.225, 2.186, 2.183, 2.197, 2.219, 2.245, 2.272}, \
		 {3.097, 2.981, 2.903, 2.472, 2.295, 2.226, 2.209, 2.215, 2.233, 2.257, 2.282}, \
		 {3.407, 3.281, 3.198, 2.607, 2.365, 2.266, 2.235, 2.234, 2.248, 2.269, 2.293}}}

	TABLE_2D cp35_45 = {{35., 40., 45.},\
		{257.49, 264.06, 270.16, 300., 350., 400., 450., 500., 550., 600., 650.}, \
		{{3.374, 3.276, 3.186, 2.741, 2.434, 2.306, 2.260, 2.252, 2.262, 2.280, 2.303}, \
		 {3.657, 3.536, 3.424, 2.876, 2.504, 2.346, 2.286, 2.270, 2.276, 2.292, 2.313}, \
		 {3.994, 3.854, 3.736, 3.086, 2.599, 2.397, 2.317, 2.291, 2.291, 2.304, 2.323}}}

	TABLE_2D cp50_60 = {{50, 55., 60.},\
		{275.55, 286.29, 294.97, 300., 350., 400., 450., 500., 550., 600., 650.}, \
		{{3.912, 3.641, 3.422, 3.296, 2.694, 2.448, 2.347, 2.312, 2.307, 2.317, 2.334}, \
		 {4.245, 3.920, 3.657, 3.505, 2.788, 2.499, 2.378, 2.332, 2.322, 2.329, 2.344}, \
		 {4.613, 4.219, 3.900, 3.715, 2.883, 2.550, 2.408, 2.353, 2.337, 2.341, 2.354}}}

	TABLE_2D cp70_80 = {{70., 80.},\
		{294.97, 300., 350., 400., 450., 500., 550., 600., 650.}, \
		{{4.706, 4.474, 3.144, 2.678, 2.481, 2.400, 2.370, 2.367, 2.375}, \
		 {5.600, 5.232, 3.404, 2.806, 2.554, 2.446, 2.403, 2.392, 2.396}}}

BODY
	Psat = pres_sat_w(T)
	Tsat = temp_sat_w(P)
--	IF (T < Tsat AND P > Psat) THEN
--		cp = linearInterp1D (cesp_vsat, P)
--		PRINT (mens_A)
	IF (T == Tsat AND P == Psat) THEN
		cp = linearInterp1D (cesp_vsat, P)
	ELSE 
	   IF (P > 0. AND P < 6.) THEN
		cp = linearInterp2D(cp1_5, P, T)
	   ELSEIF (P >= 6. AND P < 17.5) THEN
		cp = linearInterp2D(cp7_15, P, T)
	   ELSEIF (P >= 17.5 AND P < 32.5) THEN
		cp = linearInterp2D(cp20_30, P, T)
	   ELSEIF (P >= 32.5 AND P < 47.5) THEN
		cp = linearInterp2D(cp35_45, P, T)
	   ELSEIF (P >= 47.5 AND P <= 65) THEN
		cp = linearInterp2D(cp50_60, P, T)
	   ELSEIF (P >= 65. AND P <= 80.0) THEN
		cp = linearInterp2D(cp70_80, P, T)
	   ELSE
		cp = linearInterp2D(cp70_80, 80., T)
		PRINT (mens_B)
	   END IF	
	END IF
	
	RETURN cp
END FUNCTION


----------------------------------------------------------------------------------
-- VISCOSIDAD (kg/ms) de vapor sobrecalentado  en función de Temperatura (ºC) y Presión (bar)

FUNCTION REAL visc_vsobre (REAL T, REAL P)
DECLS
	REAL Tsat, Psat	
	REAL v
	CONST STRING mens_A = "mensajeA ERROR en el cálculo de la VISCOSIDAD, en esas condiciones de presión y temperatura no existe vapor, es líquido. \
					Por defecto se toma el valor correspondiente a vapor saturado a esa presión"
	CONST STRING mens_B = "mensajeB ERROR en el cálculo de la VISCOSIDAD del vapor sobrecalentado, excedido rango de presión (P <= 80. bar). \
					Por defecto se toma el valor correspondiente a P máxima"

	TABLE_2D v1_5 = {{1.0, 3.0, 5.0},\
		{151.84, 167.71, 179.88, 200., 250., 300., 350., 400., 450., 500., 550., 600., 650.}, \
		{{1.426e-5, 1.489e-5, 1.538e-5, 1.618e-5, 1.822e-5, 2.029e-5, 2.237e-5, 2.445e-5, 2.652e-5, 2.857e-5, 3.061e-5, 3.262e-5, 3.460e-5}, \
		 {1.406e-5, 1.483e-5, 1.534e-5, 1.618e-5, 1.819e-5, 2.027e-5, 2.236e-5, 2.445e-5, 2.652e-5, 2.858e-5, 3.062e-5, 3.263e-5, 3.461e-5}, \
		 {1.408e-5, 1.477e-5, 1.530e-5, 1.617e-5, 1.815e-5, 2.025e-5, 2.235e-5, 2.444e-5, 2.652e-5, 2.858e-5, 3.062e-5, 3.263e-5, 3.461e-5}}}

	TABLE_2D v7_15 = {{7.0, 10.0, 15.0},\
		{198.29, 200., 212.37, 250, 300., 350., 400., 450., 500., 550., 600., 650.}, \
		{{1.598e-5, 1.605e-5, 1.656e-5, 1.811e-5, 2.023e-5, 2.234e-5, 2.444e-5, 2.652e-5, 2.858e-5, 3.063e-5, 3.264e-5, 3.462e-5}, \
		 {1.586e-5, 1.593e-5, 1.646e-5, 1.807e-5, 2.020e-5, 2.232e-5, 2.443e-5, 2.652e-5, 2.858e-5, 3.063e-5, 3.264e-5, 3.463e-5}, \
		 {1.507e-5, 1.579e-5, 1.633e-5, 1.799e-5, 2.015e-5, 2.229e-5, 2.441e-5, 2.651e-5, 2.859e-5, 3.064e-5, 3.266e-5, 3.465e-5}}} 

	TABLE_2D v20_30 = {{20., 25., 30.},\
		{233.77, 243.52, 250., 300., 350., 400., 450., 500., 550., 600., 650.}, \
		{{1.718e-5, 1.762e-5, 1.791e-5, 2.010e-5, 2.227e-5, 2.440e-5, 2.652e-5, 2.886e-5, 3.065e-5, 3.268e-5, 3.468e-5}, \
		 {1.705e-5, 1.752e-5, 1.784e-5, 2.006e-5, 2.225e-5, 2.440e-5, 2.652e-5, 2.881e-5, 3.067e-5, 3.270e-5, 3.470e-5}, \
		 {1.692e-5, 1.742e-5, 1.776e-5, 2.002e-5, 2.223e-5, 2.439e-5, 2.653e-5, 2.875e-5, 3.069e-5, 3.272e-5, 3.473e-5}}}

	TABLE_2D v35_45 = {{35., 40., 45.},\
		{257.49, 264.06, 270.16, 300., 350., 400., 450., 500., 550., 600., 650.}, \
		{{1.797e-5, 1.828e-5, 1.856e-5, 1.997e-5, 2.220e-5, 2.439e-5, 2.653e-5, 2.870e-5, 3.070e-5, 3.274e-5, 3.475e-5}, \
		 {1.794e-5, 1.825e-5, 1.854e-5, 1.993e-5, 2.218e-5, 2.438e-5, 2.653e-5, 2.864e-5, 3.072e-5, 3.276e-5, 3.477e-5}, \
		 {1.786e-5, 1.817e-5, 1.847e-5, 1.990e-5, 2.217e-5, 2.438e-5, 2.654e-5, 2.866e-5, 3.074e-5, 3.279e-5, 3.480e-5}}}

	TABLE_2D v50_60 = {{50, 55., 60.},\
		{275.55, 286.29, 294.97, 300., 350., 400., 450., 500., 550., 600., 650.}, \
		{{1.867e-5, 1.920e-5, 1.962e-5, 1.987e-5, 2.216e-5, 2.438e-5, 2.655e-5, 2.868e-5, 3.076e-5, 3.281e-5, 3.482e-5}, \
		 {1.863e-5, 1.916e-5, 1.958e-5, 1.983e-5, 2.215e-5, 2.438e-5, 2.656e-5, 2.869e-5, 3.078e-5, 3.284e-5, 3.485e-5}, \
		 {1.861e-5, 1.913e-5, 1.956e-5, 1.980e-5, 2.214e-5, 2.438e-5, 2.657e-5, 2.871e-5, 3.080e-5, 3.286e-5, 3.487e-5}}}

	TABLE_2D v70_80 = {{70., 80.},\
		{294.97, 300., 350., 400., 450., 500., 550., 600., 650.}, \
		{{1.951e-5, 1.977e-5, 2.214e-5, 2.440e-5, 2.660e-5, 2.875e-5, 3.085e-5, 3.291e-5, 3.493e-5}, \
		 {1.949e-5, 1.974e-5, 2.213e-5, 2.442e-5, 2.663e-5, 2.879e-5, 3.090e-5, 3.296e-5, 3.499e-5}}}

BODY
	Psat = pres_sat_w(T)
	Tsat = temp_sat_w(P)
--	IF (T < Tsat AND P > Psat) THEN
--		v = linearInterp1D (visc_vsat, P)
--		PRINT (mens_A)
	IF (T == Tsat AND P == Psat) THEN
		v = linearInterp1D (visc_vsat, P)
	ELSE 
	   IF (P > 0. AND P < 6.) THEN
		v = linearInterp2D(v1_5, P, T)
	   ELSEIF (P >= 6. AND P < 17.5) THEN
		v = linearInterp2D(v7_15, P, T)
	   ELSEIF (P >= 17.5 AND P < 32.5) THEN
		v = linearInterp2D(v20_30, P, T)
	   ELSEIF (P >= 32.5 AND P < 47.5) THEN
		v = linearInterp2D(v35_45, P, T)
	   ELSEIF (P >= 47.5 AND P <= 65) THEN
		v = linearInterp2D(v50_60, P, T)
	   ELSEIF (P >= 65. AND P <= 80.0) THEN
		v = linearInterp2D(v70_80, P, T)
	   ELSE
		v = linearInterp2D(v70_80, 80., T)
		PRINT (mens_B)
	   END IF	
	END IF

	RETURN v
END FUNCTION


----------------------------------------------------------------------------------
-- CONDUCTIVIDAD (kW/mºC) de vapor sobrecalentado  en función de Temperatura (ºC) y Presión (bar)

FUNCTION REAL cond_vsobre (REAL T, REAL P)
DECLS
	REAL Tsat, Psat	
	REAL k
	CONST STRING mens_A = "mensajeA ERROR en el cálculo de la CONDUCTIVIDAD, en esas condiciones de presión y temperatura no existe vapor, es líquido. \
					Por defecto se toma el valor correspondiente a vapor saturado a esa presión"
	CONST STRING mens_B = "mensajeB ERROR en el cálculo de la CONDUCTIVIDAD del vapor sobrecalentado, excedido rango de presión (P <= 80. bar). \
					Por defecto se toma el valor correspondiente a P máxima"

	TABLE_2D k1_5 = {{1.0, 3.0, 5.0},\
		{151.84, 167.71, 179.88, 200., 250., 300., 350., 400., 450., 500., 550., 600., 650.}, \
		{{2.897e-5, 3.042e-5, 3.153e-5, 3.337e-5, 3.828e-5, 4.349e-5, 4.897e-5, 5.471e-5, 6.069e-5, 6.689e-5, 7.330e-5, 7.989e-5, 8.665e-5}, \
		 {2.969e-5, 3.125e-5, 3.221e-5, 3.381e-5, 3.855e-5, 4.369e-5, 4.915e-5, 3.025e-4, 6.084e-5, 6.703e-5, 7.343e-5, 8.001e-5, 8.677e-5}, \
		 {3.103e-5, 3.209e-5, 3.290e-5, 3.424e-5, 3.881e-5, 4.389e-5, 4.932e-5, 5.502e-4, 6.098e-5, 6.716e-5, 7.355e-5, 8.013e-5, 8.688e-5}}} 

	TABLE_2D k7_15 = {{7.0, 10.0, 15.0},\
		{198.29, 200., 212.37, 250, 300., 350., 400., 450., 500., 550., 600., 650.}, \
		{{3.506e-5, 3.515e-5, 3.616e-5, 3.925e-5, 4.419e-5, 4.956e-5, 3.028e-4, 6.117e-5, 6.733e-5, 7.371e-5, 8.028e-5, 8.702e-5}, \
		 {3.600e-5, 3.606e-5, 3.696e-5, 3.969e-5, 4.449e-5, 4.979e-5, 5.543e-5, 6.135e-5, 6.750e-5, 7.387e-5, 8.043e-5, 8.716e-5}, \
		 {3.540e-5, 3.875e-5, 3.926e-5, 4.082e-5, 4.517e-5, 5.031e-5, 5.587e-5, 6.173e-5, 6.786e-5, 7.420e-5, 8.073e-5, 8.745e-5}}} 

	TABLE_2D k20_30 = {{20., 25., 30.},\
		{233.77, 243.52, 250., 300., 350., 400., 450., 500., 550., 600., 650.}, \
		{{4.197e-5, 4.212e-5, 4.222e-5, 4.595e-5, 5.086e-5, 5.633e-5, 6.214e-5, 6.822e-5, 7.453e-5, 8.105e-5, 8.774e-5}, \
		 {4.422e-5, 4.438e-5, 4.449e-5, 4.700e-5, 5.153e-5, 5.685e-5, 6.259e-5, 6.862e-5, 7.489e-5, 8.138e-5, 8.805e-5}, \
		 {4.647e-5, 4.664e-5, 4.675e-5, 4.805e-5, 5.221e-5, 5.737e-5, 6.303e-5, 6.901e-5, 7.525e-5, 8.171e-5, 8.836e-5}}}

	TABLE_2D k35_45 = {{35., 40., 45.},\
		{257.49, 264.06, 270.16, 300., 350., 400., 450., 500., 550., 600., 650.}, \
		{{4.893e-5, 4.895e-5, 4.898e-5, 4.909e-5, 5.288e-5, 5.789e-5, 6.348e-5, 6.941e-5, 7.560e-5, 8.204e-5, 8.866e-5}, \
		 {5.112e-5, 5.096e-5, 5.082e-5, 5.014e-5, 5.355e-5, 5.841e-5, 6.392e-5, 6.980e-5, 7.596e-5, 8.237e-5, 8.897e-5}, \
		 {5.346e-5, 5.320e-5, 5.304e-5, 5.177e-5, 5.445e-5, 5.905e-5, 6.443e-5, 7.024e-5, 7.636e-5, 8.273e-5, 8.930e-5}}}

	TABLE_2D k50_60 = {{50, 55., 60.},\
		{275.55, 286.29, 294.97, 300., 350., 400., 450., 500., 550., 600., 650.}, \
		{{5.493e-5, 5.426e-5, 5.372e-5, 5.341e-5, 5.535e-5, 5.969e-5, 6.495e-5, 7.068e-5, 7.675e-5, 8.309e-5, 8.963e-5}, \
		 {5.731e-5, 5.631e-5, 5.550e-5, 5.504e-5, 5.624e-5, 6.032e-5, 6.546e-5, 7.112e-5, 7.715e-5, 8.344e-5, 8.995e-5}, \
		 {5.999e-5, 5.853e-5, 5.735e-5, 5.667e-5, 5.714e-5, 6.096e-5, 6.597e-5, 7.156e-5, 7.754e-5, 8.380e-5, 9.028e-5}}}

	TABLE_2D k70_80 = {{70., 80.},\
		{294.97, 300., 350., 400., 450., 500., 550., 600., 650.}, \
		{{6.289e-5, 6.197e-5, 5.955e-5, 6.252e-5, 6.717e-5, 7.255e-5, 7.840e-5, 8.457e-5, 9.099e-5}, \
		 {6.896e-5, 6.727e-5, 6.196e-5, 6.408e-5, 6.836e-5, 7.354e-5, 7.926e-5, 8.534e-5, 9.169e-5}}}

BODY
	Psat = pres_sat_w(T)
	Tsat = temp_sat_w(P)
--	IF (T < Tsat AND P > Psat) THEN
--		k = linearInterp1D (cond_vsat, P)
--		PRINT (mens_A)
	IF (T == Tsat AND P == Psat) THEN
		k = linearInterp1D (cond_vsat, P)
	ELSE 
	   IF (P > 0. AND P < 6.) THEN
		k = linearInterp2D(k1_5, P, T)
	   ELSEIF (P >= 6. AND P < 17.5) THEN
		k = linearInterp2D(k7_15, P, T)
	   ELSEIF (P >= 17.5 AND P < 32.5) THEN
		k = linearInterp2D(k20_30, P, T)
	   ELSEIF (P >= 32.5 AND P < 47.5) THEN
		k = linearInterp2D(k35_45, P, T)
	   ELSEIF (P >= 47.5 AND P <= 65) THEN
		k = linearInterp2D(k50_60, P, T)
	   ELSEIF (P >= 65. AND P <= 80.0) THEN
		k = linearInterp2D(k70_80, P, T)
	   ELSE
		k = linearInterp2D(k70_80, 80., T)
		PRINT (mens_B)
	   END IF	
	END IF

	RETURN k
END FUNCTION


------------------------------------------------------------------------
-- NÚMERO DE PRANDLT del vapor sobrecalentado en función de Temperatura (ºC) y Presión (bar)

FUNCTION REAL nPrand_vsobre (REAL T, REAL P)
DECLS
	REAL Tsat, Psat	
	REAL nPr
	CONST STRING mens_A = "mensajeA ERROR en el cálculo del NÚMERO DE PRAND , en esas condiciones de presión y temperatura no existe vapor, es líquido. \
					Por defecto se toma el valor correspondiente a vapor saturado a esa presión"
	CONST STRING mens_B = "mensajeB ERROR en el cálculo del NÚMERO DE PRAND del vapor sobrecalentado, excedido rango de presión (P <= 80. bar). \
					Por defecto se toma el valor correspondiente a P máxima"

	TABLE_2D nPr1_5 = {{1.0, 3.0, 5.0},\
		{151.84, 167.71, 179.88, 200., 250., 300., 350., 400., 450., 500., 550., 600., 650.}, \
		{{0.98, 0.97, 0.97, 0.96, 0.95, 0.94, 0.93, 0.92, 0.92, 0.91, 0.91, 0.90, 0.89}, \
		 {1.02, 1.01, 1.00, 0.99, 0.97, 0.95, 0.94, 0.93, 0.92, 0.91, 0.91, 0.90, 0.89}, \
		 {1.06, 1.04, 1.03, 1.01, 0.98, 0.95, 0.94, 0.93, 0.92, 0.91, 0.91, 0.90, 0.89}}} 

	TABLE_2D nPr7_15 = {{7.0, 10.0, 15.0},\
		{198.29, 200., 212.37, 250, 300., 350., 400., 450., 500., 550., 600., 650.}, \
		{{1.05, 1.05, 1.03, 1.00, 0.96, 0.95, 0.93, 0.92, 0.92, 0.91, 0.90, 0.90}, \
		 {1.08, 1.08, 1.07, 1.02, 0.97, 0.95, 0.93, 0.92, 0.92, 0.91, 0.90, 0.90}, \
		 {1.14, 1.14, 1.12, 1.06, 1.00, 0.96, 0.94, 0.93, 0.92, 0.91, 0.90, 0.90}}} 

	TABLE_2D nPr20_30 = {{20., 25., 30.},\
		{233.77, 243.52, 250., 300., 350., 400., 450., 500., 550., 600., 650.}, \
		{{1.14, 1.12, 1.11, 1.02, 0.97, 0.95, 0.93, 0.92, 0.91, 0.91, 0.90}, \
		 {1.19, 1.21, 1.16, 1.05, 0.99, 0.96, 0.94, 0.92, 0.91, 0.91, 0.90}, \
		 {1.24, 1.22, 1.21, 1.08, 1.01, 0.97, 0.94, 0.92, 0.92, 0.91, 0.90}}}

	TABLE_2D nPr35_45 = {{35., 40., 45.},\
		{257.49, 264.06, 270.16, 300., 350., 400., 450., 500., 550., 600., 650.}, \
		{{1.23, 1.21, 1.19, 1.11, 1.02, 0.97, 0.95, 0.92, 0.92, 0.91, 0.90}, \
		 {1.28, 1.26, 1.24, 1.14, 1.04, 0.98, 0.95, 0.92, 0.92, 0.91, 0.90}, \
		 {1.33, 1.31, 1.29, 1.18, 1.06, 0.99, 0.96, 0.92, 0.92, 0.91, 0.90}}}

	TABLE_2D nPr50_60 = {{50, 55., 60.},\
		{275.55, 286.29, 294.97, 300., 350., 400., 450., 500., 550., 600., 650.}, \
		{{1.32, 1.28, 1.24, 1.22, 1.08, 1.00, 0.96, 0.93, 0.93, 0.92, 0.91}, \
		 {1.37, 1.32, 1.28, 1.26, 1.10, 1.01, 0.97, 0.93, 0.93, 0.92, 0.91}, \
		 {1.43, 1.37, 1.33, 1.30, 1.12, 1.02, 0.97, 0.93, 0.93, 0.92, 0.91}}}

	TABLE_2D nPr70_80 = {{70., 80.},\
		{294.97, 300., 350., 400., 450., 500., 550., 600., 650.}, \
		{{1.45, 1.42, 1.17, 1.05, 0.99, 0.94, 0.94, 0.92, 0.91}, \
		 {1.58, 1.53, 1.22, 1.07, 1.00, 0.94, 0.94, 0.92, 0.91}}}

BODY
	Psat = pres_sat_w(T)
	Tsat = temp_sat_w(P)
--	IF (T < Tsat AND P > Psat) THEN
--		nPr = linearInterp1D (nPr_vsat, P)
--		PRINT (mens_A)
	IF (T == Tsat AND P == Psat) THEN
		nPr = linearInterp1D (nPr_vsat, P)
	ELSE 
	   IF (P > 0. AND P < 6.) THEN
		nPr = linearInterp2D(nPr1_5, P, T)
	   ELSEIF (P >= 6. AND P < 17.5) THEN
		nPr = linearInterp2D(nPr7_15, P, T)
	   ELSEIF (P >= 17.5 AND P < 32.5) THEN
		nPr = linearInterp2D(nPr20_30, P, T)
	   ELSEIF (P >= 32.5 AND P < 47.5) THEN
		nPr = linearInterp2D(nPr35_45, P, T)
	   ELSEIF (P >= 47.5 AND P <= 65) THEN
		nPr = linearInterp2D(nPr50_60, P, T)
	   ELSEIF (P >= 65. AND P <= 80.0) THEN
		nPr = linearInterp2D(nPr70_80, P, T)
	   ELSE
		nPr = linearInterp2D(nPr70_80, 80., T)
		PRINT (mens_B)
	   END IF	
	END IF

	RETURN nPr
END FUNCTION

----------------------------------------------------------------------------------------
-- ENTROPÍA ESPECÍFICA (kJ/kgK) de vapor sobrecalentado  en función de Temperatura (ºC) y Presión (bar)

--FUNCTION REAL entrop_vsobre (REAL T, REAL P)
--DECLS
--	REAL Psat, Tsat	
--	REAL s
--	CONST STRING mens_A = "mensajeA: ERROR en el cálculo de la ENTROPÍA ESPECÍFICA, en esas condiciones de presión y temperatura no existe vapor, es líquido. \
--					Por defecto se toma el valor correspondiente a vapor saturado a esa presión"
--	CONST STRING mens_B = "mensajeB ERROR en el cálculo de la ENTROPÍA ESPECÍFICA del vapor sobrecalentado, excedido rango de presión (P <= 80. bar). \
--					Por defecto se toma el valor correspondiente a P máxima"
--
--	TABLE_2D s006_07 = {{0.06, 0.35, 0.7}, \
--		{89.95, 100., 120., 160., 200., 240., 280., 320., 360., 400., 440., 500.}, \
--		{{8.6310, 8.6822, 8.7840, 8.9693, 9.1398, 9.2982, 9.4464, 9.5859, 9.7180, 9.8435, 9.9633, 10.1336}, \
--		 {7.8081, 7.8345, 7.9644, 8.1519, 8.3237, 8.4828, 8.6314, 8.7712, 8.9034, 9.0291, 9.1490, 9.3194}, \
--		 {7.4797, 7.5341, 7.6375, 7.8279, 8.0012, 8.1611, 8.3162, 8.4504, 8.5828, 8.7086, 8.8286, 8.9991}}}
--
--	TABLE_2D s1_3 = {{1.0, 1.5, 3.0},\
--		{133.55, 160., 200., 240., 280., 320., 360., 400., 440., 500.}, \
--		{{7.5321, 7.6597, 7.8343, 7.9949, 8.1445, 8.2849, 8.4175, 8.5435, 8.6636, 8.8342}, \
--		 {7.3361, 7.4665, 7.6433, 7.8052, 7.9555, 8.0964, 8.2293, 8.3555, 8.4757, 8.6466}, \
--		 {6.9919, 7.1276, 7.3115, 7.4774, 7.6299, 7.7722, 7.9061, 8.0330, 8.1538, 8.3251}}} 
--
--	TABLE_2D s5_15 = {{5.0, 7.0, 10.0, 15.0},\
--		{198.32, 240., 280., 320., 360., 400., 440., 500., 540., 600., 640. }, \
--		{{7.0513, 7.2307, 7.3865, 7.5308, 7.6660, 7.7938, 7.9152, 8.0873, 8.1933, 8.3522, 8.4494}, \
--		 {6.8782, 7.0641, 7.2233, 7.3697, 7.5063, 7.6350, 7.7571, 7.9299, 8.0362, 8.1956, 8.2930}, \
--		 {6.6850, 6.8817, 7.0465, 7.1962, 7.3349, 7.4651, 7.5883, 7.7622, 7.8720, 8.0290, 8.1290}, \
--		 {6.4448, 6.6628, 6.8381, 6.9938, 7.1363, 7.2690, 7.3940, 7.5698, 7.6805, 7.8385, 7.9391}}}
--
--	TABLE_2D s20_35 = {{20., 25., 30., 35.}, \
--		{242.6, 264., 280., 320., 360., 400., 440., 500., 540., 600., 640., 700.}, \
--		{{6.5074, 6.6078, 6.6828, 6.8452, 6.9917, 7.1271, 7.2540, 7.4317, 7.5434, 7.7024, 7.8035, 7.9487}, \
--		 {6.3741, 6.4830, 6.5645, 6.7349, 6.8859, 7.0242, 7.1530, 7.3328, 7.4454, 7.6055, 7.7071, 7.8529}, \
--		 {6.2408, 6.3583, 6.4462, 6.6245, 6.7801, 6.9212, 7.0520, 7.2338, 7.3474, 7.5085, 7.6106, 7.7571}, \
--		 {6.1253, 6.2571, 6.3515, 6.5399, 6.7008, 6.8451, 6.9781, 7.1620, 7.2765, 7.4387, 7.5413, 7.6885}}}
--
--	TABLE_2D s40_55= {{40., 45., 50., 55.}, \
--		{270.16, 280., 320., 360., 400., 440., 500., 540., 600., 640., 700.}, \
--		{{6.1947, 6.2568, 6.4553, 6.6215, 6.7690, 6.9041, 7.0901, 7.2056, 7.3688, 7.4720, 7.6198}, \
--		 {6.1067, 6.1739, 6.3876, 6.5607, 6.7120, 6.8494, 7.0377, 7.1542, 7.3185, 7.4223, 7.5707}, \
--		 {6.0187, 6.0910, 6.3200, 6.4999, 6.6549, 6.7947, 6.9852, 7.1028, 7.2683, 7.3726, 7.5216}, \
--		 {5.9313, 6.0081, 6.2523, 6.4390, 6.5979, 6.7400, 6.9328, 7.0513, 7.2180, 7.3228, 7.4725}}}
--
--	TABLE_2D s60_70 = {{60., 65., 70.}, \
--		{285.9, 291.09, 295.06, 320., 360., 400., 440., 480., 520., 560., 600., 640., 700., 740.}, \
--		{{5.9635, 5.9971, 6.0229, 6.1846, 6.3782, 6.5408, 6.6853, 6.8153, 6.9401, 7.0558, 7.1677, 7.2731, 7.4234, 7.5190}, \
--		 {5.8861, 5.9245, 5.9521, 6.1257, 6.3291, 6.4965, 6.6437, 6.7761, 6.9019, 7.0187, 7.1309, 7.2369, 7.3879, 7.4838}, \
--		 {5.8133, 5.8519, 5.8814, 6.0668, 6.2801, 6.4521, 6.6022, 6.7370, 6.8636, 6.9815, 7.0942, 7.2007, 7.3523, 7.4486}}}
--
--	TABLE_2D s75_80 = {{75., 80.}, \
--		{295.06, 320., 360., 400., 440., 480., 520., 560., 600., 640., 700., 740.}, \
--		{{5.8098, 6.0078, 6.2310, 6.4078, 6.5606, 6.6978, 6.8254, 6.9444, 7.0574, 7.1645, 7.3168, 7.4134}, \
--		 {5.7432, 5.9489, 6.1819, 6.3634, 6.5190, 6.6586, 6.7871, 6.9072, 7.0206, 7.1283, 7.2812, 7.3782}}}
--BODY
--	Psat = pres_sat_w(T)
--	Tsat = temp_sat_w(P)
----	IF (T < Tsat AND P > Psat) THEN
----		s = linearInterp1D(entrop_vsat_T,T)
----		PRINT (mens_A)
--	IF (T == Tsat AND P == Psat) THEN
--		s = linearInterp1D(entrop_vsat_T,T)
--	ELSE 
--	   IF (P > 0. AND P < 1.) THEN
--		s = linearInterp2D(s006_07, P, T)
--	   ELSEIF (P >= 1. AND P < 4.) THEN
--		s = linearInterp2D(s1_3, P, T)
--	   ELSEIF (P >= 4. AND P < 17.5) THEN
--		s = linearInterp2D(s5_15, P, T)
--	   ELSEIF (P >= 17.5 AND P < 37.5) THEN
--		s = linearInterp2D(s20_35, P, T)
--	   ELSEIF (P >= 37.5 AND P < 57.5) THEN
--		s = linearInterp2D(s40_55, P, T)
--	   ELSEIF (P >= 57.5 AND P <= 72.5) THEN
--		s = linearInterp2D(s60_70, P, T)
--	   ELSEIF (P >= 72.5 AND P <= 80.0) THEN
--		s = linearInterp2D(s75_80, P, T)
--	   ELSE
--		s = linearInterp2D(s75_80, 80., T)
--		PRINT (mens_B)
--	   END IF	
--	END IF
--
--	RETURN s
--END FUNCTION

----------------------------------------------------------------------------------------
-- ENTROPÍA ESPECÍFICA (kJ/kgK) de vapor sobrecalentado  en función de Temperatura (ºC) y Presión (bar)

FUNCTION REAL entrop_vsobre (REAL T, REAL P)
DECLS
	REAL Tsat	
	REAL s
--	CONST STRING mens_A = "mensajeA ERROR en el cálculo de la ENTROPÍA, en esas condiciones de presión y temperatura no existe vapor, es líquido. \
--					Por defecto se toma el valor correspondiente a vapor saturado a esa presión"
--	CONST STRING mens_B = "mensajeB ERROR en el cálculo de la ENTROPÍA del vapor sobrecalentado, excedido rango de presión (P <= 70. bar). \
--					Por defecto se toma el valor correspondiente a Pmáxima (70 bar)"
--	CONST STRING mens_C = "mensajeC ERROR en el cálculo de la ENTROPÍA del vapor sobrecalentado: excedido rango de presión -> se toma P=70 bar; \
--					a 70 bar y esa temperatura no existe vapor -> se toma el vapor de saturación a 70 bares"

	TABLE_2D s05_70 = {{0.5, 1.0, 3.0, 5.0, 7.0, 10.0, 15.0, 20.0, 25.0, 30.0, 35.0, 40.0, 45.0, 50.0, 55.0, 60.0, 65.0, 70.0}, \
		{81.317, 99.606, 115.0, 133.522, 151.831, 164.946, 179.878, 198.287, 212.377, 223.95, 233.853, 242.557, 250.354, \
		 257.437, 263.941, 269.965, 275.585, 280.858, 285.829, 300.0, 320.0, 340.0, 360.0, 380.0, 400.0, 420.0, \
		 440.0, 460.0, 480.0, 500.0, 520.0, 540.0, 560.0, 580.0, 600.0, 620.0, 640.0}, \

		{{7.5930, 7.6932, 7.7728, 7.8639, 7.9497, 8.0089, 8.0742, 8.1521, 8.2098, 8.2561, 8.2949, 8.3285, 8.3582, \
		  8.3848, 8.4090, 8.4311, 8.4516, 8.4707, 8.4885, 8.5386, 8.6076, 8.6747, 8.7401, 8.8038, 8.8659, 8.9266, \
		  8.9859, 9.0440, 9.1009, 9.1566, 9.2115, 9.2648, 9.3175, 9.3692, 9.4201, 9.4701, 9.5193}, \

		 {7.3589, 7.3589, 7.4419, 7.5357, 7.6233, 7.6835, 7.7497, 7.8284, 7.8866, 7.9332, 7.9727, 8.0061, 8.0359, \
		  8.0627, 8.0870, 8.1092, 8.1298, 8.1490, 8.1668, 8.2172, 8.2864, 8.3536, 8.4191, 8.4829, 8.5452, 8.6059, \
		  8.6654, 8.7235, 8.7804, 8.8362, 8.8908, 8.9445, 8.9972, 9.0489, 9.0998, 9.1499, 9.1991}, \

		 {6.9916, 6.9916, 6.9916, 6.9916, 7.0885, 7.1532, 7.2234, 7.3057, 7.3702, 7.4141, 7.4543, 7.4889, 7.5194, \
		  7.5479, 7.5715, 7.5941, 7.6151, 7.6345, 7.6527, 7.7037, 7.7738, 7.8417, 7.9078, 7.9721, 8.0347, 8.0959, \
		  8.1556, 8.2140, 8.2711, 8.3271, 8.3819, 8.4357, 8.4886, 8.5404, 8.5914, 8.6416, 8.6909}, \

		 {6.8207, 6.8207, 6.8207, 6.8207, 6.8207, 6.8917, 6.9667, 7.0532, 7.1160, 7.1657, 7.2071, 7.2426, 7.2742, \
		  7.3017, 7.3270, 7.3501, 7.3714, 7.3912, 7.4097, 7.4614, 7.5323, 7.6010, 7.6677, 7.7325, 7.7955, 7.8570, \
		  7.9171, 7.9757, 8.0331, 8.0892, 8.1443, 8.1983, 8.2512, 8.3032, 8.3543, 8.4146, 8.4540}, \

		 {6.7071, 6.7071, 6.7071, 6.7071, 6.7071, 6.7071, 6.7886, 6.8830, 6.9457, 6.9973, 7.0399, 7.0764, 7.1088, \
		  7.1370, 7.1629, 7.1863, 7.2080, 7.2282, 7.2469, 7.2995, 7.3713, 7.4407, 7.5080, 7.5733, 7.6368, 7.6987, \
		  7.7590, 7.8179, 7.8755, 7.9319, 7.9871, 8.0412, 8.0943, 8.1465, 8.1977, 8.2483, 8.2976}, \

		 {6.5850, 6.5850, 6.5850, 6.5850, 6.5850, 6.5850, 6.5850, 6.6867, 6.7571, 6.8113, 6.8565, 6.8947, 6.9280, \
		  6.9576, 6.9843, 7.0086, 7.0309, 7.0516, 7.0708, 7.1246, 7.1979, 7.2685, 7.3367, 7.4028, 7.4669, 7.5294, \
		  7.5902, 7.6495, 7.7075, 7.7642, 7.8196, 7.8740, 7.9273, 7.9797, 8.0310, 8.0815, 8.1312}, \

		 {6.4430, 6.4430, 6.4430, 6.4430, 6.4430, 6.4430, 6.4430, 6.4430, 6.5252, 6.5858, 6.6360, 6.6996, 6.7127, \
		  6.7443, 6.7726, 6.7983, 6.8218, 6.8435, 6.8637, 6.9198, 6.9957, 7.0683, 7.1382, 7.2057, 7.2710, 7.3343, \
		  7.3960, 7.4560, 7.5146, 7.5718, 7.6277, 7.6825, 7.7362, 7.7888, 7.8405, 7.8913, 7.9411}, \

		 {6.3390, 6.3390, 6.3390, 6.3390, 6.3390, 6.3390, 6.3390, 6.3390, 6.3390, 6.4099, 6.4649, 6.5104, 6.5492, \
		  6.5832, 6.6135, 6.6408, 6.6657, 6.6886, 6.7098, 6.7684, 6.8472, 6.9221, 6.9937, 7.0627, 7.1292, 7.1935, \
		  7.2560, 7.3168, 7.3760, 7.4337, 7.4901, 7.5453, 7.5994, 7.6523, 7.7043, 7.7553, 7.8054}, \

		 {6.2558, 6.2558, 6.2558, 6.2558, 6.2558, 6.2558, 6.2558, 6.2558, 6.2558, 6.2558, 6.3193, 6.3700, 6.4126, \
		  6.4495, 6.4821, 6.5113, 6.5377, 6.5620, 6.5844, 6.6459, 6.7278, 6.8052, 6.8788, 6.9492, 7.0170, 7.0824, \
		  7.1458, 7.2073, 7.2671, 7.3254, 7.3823, 7.4379, 7.4923, 7.5456, 7.5979, 7.6491, 7.6995}, \

		 {6.1856, 6.1856, 6.1856, 6.1856, 6.1856, 6.1856, 6.1856, 6.1856, 6.1856, 6.1856, 6.1856, 6.2502, 6.2914, \
		  6.3318, 6.3671, 6.3986, 6.4269, 6.4527, 6.4765, 6.5412, 6.6266, 6.7066, 6.7828, 6.8544, 6.9235, 6.9900, \
		  7.0542, 7.1165, 7.1770, 7.2359, 7.2933, 7.3493, 7.4041, 7.4577, 7.5103, 7.5618, 7.6124}, \

		 {6.1243, 6.1243, 6.1243, 6.1243, 6.1243, 6.1243, 6.1243, 6.1243, 6.1243, 6.1243, 6.1243, 6.1243, 6.1787, \
		  6.2238, 6.2625, 6.2966, 6.3271, 6.3548, 6.3800, 6.4484, 6.5377, 6.6206, 6.6984, 6.7723, 6.8427, 6.9104, \
		  6.9756, 7.0387, 7.0998, 7.1593, 7.2172, 7.2737, 7.3288, 7.3828, 7.4357, 7.4875, 7.5383}, \

		 {6.0676, 6.0676, 6.0676, 6.0676, 6.0676, 6.0676, 6.0676, 6.0676, 6.0676, 6.0676, 6.0676, 6.0676, 6.0676, \
		  6.1210, 6.1641, 6.2014, 6.2345, 6.2643, 6.2913, 6.3639, 6.4576, 6.5435, 6.6238, 6.6994, 6.7714, 6.8402, \
		  6.9064, 6.9703, 7.0321, 7.0922, 7.1506, 7.2075, 7.2631, 7.3174, 7.3705, 7.4226, 7.4737}, \

		 {6.0197, 6.0197, 6.0197, 6.0197, 6.0197, 6.0197, 6.0197, 6.0197, 6.0197, 6.0197, 6.0197, 6.0197, 6.0197, \
		  6.0197, 6.0688, 6.1103, 6.1466, 6.1789, 6.2080, 6.2854, 6.3838, 6.4732, 6.5560, 6.6336, 6.7071, 6.7771, \
		  6.8443, 6.9091, 6.9716, 7.0323, 7.0912, 7.1486, 7.2046, 7.2592, 7.3127, 7.3650, 7.4163}, \

		 {5.9737, 5.9737, 5.9737, 5.9737, 5.9737, 5.9737, 5.9737, 5.9737, 5.9737, 5.9737, 5.9737, 5.9737, 5.9737, \
		  5.9737, 5.9737, 6.0209, 6.0612, 6.0965, 6.1282, 6.2111, 6.3149, 6.4080, 6.4935, 6.5732, 6.6483, 6.7196, \
		  6.7879, 6.8535, 6.9168, 6.9781, 7.0376, 7.0954, 7.1517, 7.2068, 7.2605, 7.3131, 7.3647}, \

		 {5.9307, 5.9307, 5.9307, 5.9307, 5.9307, 5.9307, 5.9307, 5.9307, 5.9307, 5.9307, 5.9307, 5.9307, 5.9307, \
		  5.9307, 5.9307, 5.9307, 5.9764, 6.0157, 6.0503, 6.1397, 6.2496, 6.3468, 6.4352, 6.5171, 6.5939, 6.6666, \
		  6.7360, 6.8025, 6.8666, 6.9285, 6.9885, 7.0468, 7.1035, 7.1589, 7.2130, 7.2659, 7.3177}, \

		 {5.8901, 5.8901, 5.8901, 5.8901, 5.8901, 5.8901, 5.8901, 5.8901, 5.8901, 5.8901, 5.8901, 5.8901, 5.8901, \
		  5.8901, 5.8901, 5.8901, 5.8901, 5.9347, 5.9731, 6.0703, 6.1871, 6.2888, 6.3804, 6.4646, 6.5432, 6.6173, \
		  6.6878, 6.7552, 6.8201, 6.8826, 6.9432, 7.0020, 7.0591, 7.1149, 7.1693, 7.2225, 7.2745}, \

		 {5.8516, 5.8516, 5.8516, 5.8516, 5.8516, 5.8516, 5.8516, 5.8516, 5.8516, 5.8516, 5.8516, 5.8516, 5.8516, \
		  5.8516, 5.8516, 5.8516, 5.8516, 5.8516, 5.8952, 6.0019, 6.1266, 6.2333, 6.3283, 6.4150, 6.4954, 6.5710, \
		  6.6427, 6.7111, 6.7767, 6.8399, 6.9011, 6.9603, 7.0179, 7.0740, 7.1288, 7.1822, 7.2345}, \

		 {5.8148, 5.8148, 5.8148, 5.8148, 5.8148, 5.8148, 5.8148, 5.8148, 5.8148, 5.8148, 5.8148, 5.8148, 5.8148, \
		  5.8148, 5.8148, 5.8148, 5.8148, 5.8148, 5.8148, 5.9337, 6.0675, 6.1797, 6.2784, 6.3678, 6.4502, 6.5273, \
		  6.6002, 6.6696, 6.7360, 6.8000, 6.8617, 6.9214, 6.9795, 7.0359, 7.0910, 7.1447, 7.1973}}}

BODY
	Tsat = temp_sat_w(P)
	IF (P > 0. AND P <= 70) THEN
		s = linearInterp2D(s05_70, P, T)
--		IF (T < Tsat-0.1) THEN
--			PRINT (mens_A)
--		END IF
	ELSE
		s = linearInterp2D(s05_70, 70., T)
--		PRINT (mens_B)
--		IF (T < temp_sat_w(70)-0.1) THEN
--			PRINT (mens_C)
--		END IF
	END IF	
	RETURN s
END FUNCTION

---------------------------------------------------------------------------------------
-- TEMPERATURA (ºC) de vapor sobrecalentado en función de ENTROPÍA ESPECÍFICA (kJ/kgºC)
-- y Presión (bar)

FUNCTION REAL T_entrop_vsobre (REAL S_in, REAL P)
DECLS
	REAL T
	REAL S

BODY
	S = entrop_vsobre(T,P)
	S_in = S

	RETURN T

END FUNCTION


--------------------------------------------------------------------------
--------------------------------------------------------------------------
-- funciones para diferenciar vapor saturado de vapor sobrecalentado -----
--------------------------------------------------------------------------
--------------------------------------------------------------------------

-- DENSIDAD (kg/m3) del vapor de agua en función de su temperatura (ºC) y presión (bar)

FUNCTION REAL dvapor (REAL T, REAL P)
DECLS
	REAL dens
	REAL tsat
	CONST	STRING mensaje1 = "mensaje1 ERROR en el calculo DENSIDAD del VAPOR: a esa P y T no existe vapor de agua, es líquido. \
					Por defecto se toma el valor correspondiente a vapor saturado a esa presión"
BODY
	tsat = temp_sat_w(P)
	
--	IF (T < tsat) THEN
--		dens = linearInterp1D(dens_vsat,P)
--		PRINT (mensaje1)
	IF (T == tsat) THEN
		dens = linearInterp1D(dens_vsat,P)	
	ELSE 
		dens = dens_vsobre (T,P)		
	END IF

	RETURN dens
END FUNCTION


-------------------------------------------------------------------------
-- ENTALPÍA ESPECÍFICA (kJ/kg) del vapor de agua en función de su temperatura (ºC) y presión (bar)

FUNCTION REAL hvapor (REAL T, REAL P)
DECLS
	REAL h
	REAL tsat
	CONST	STRING mensaje1 = "mensaje1: ERROR en el calculo ENTALPÍA ESPECÍFICA del VAPOR: a esa P y T no existe vapor de agua, es líquido. \
					Por defecto se toma el valor correspondiente a vapor saturado a esa presión"
BODY
	tsat = temp_sat_w(P)

--	IF (T < tsat) THEN
--		h = entalp_vsat_T(T)
--		PRINT (mensaje1)
	IF (T == tsat) THEN
		h = entalp_vsat_T(T)	
	ELSE 
		h = entalp_vsobre (T,P)
	END IF

	RETURN h
END FUNCTION

-------------------------------------------------------------------------
-- VISCOSIDAD (kg/ms) del vapor de agua en función de su temperatura (ºC) y presión (bar)

FUNCTION REAL visc_vapor (REAL T, REAL P)
DECLS
	REAL vis
	REAL tsat
	CONST	STRING mensaje1 = "mensaje1 ERROR en el calculo VISCOSIDAD del VAPOR: a esa P y T no existe vapor de agua, es líquido. \
					Por defecto se toma el valor correspondiente a vapor saturado a esa presión"
BODY
	tsat = temp_sat_w(P)

--	IF (T < tsat) THEN
--		vis = linearInterp1D(visc_vsat,P)	
--		PRINT (mensaje1)
	IF (T == tsat) THEN
		vis = linearInterp1D(visc_vsat,P)	
	ELSE 
		vis = visc_vsobre (T,P)
	END IF

	RETURN vis
END FUNCTION


-------------------------------------------------------------------------
-- CONDUCTIVIDAD CALORÍFICA del vapor (kW/mºC) de agua en función de su temperatura (ºC) y presión (ºC)

FUNCTION REAL cond_vapor (REAL T, REAL P)
DECLS
	REAL cond
	REAL tsat
	CONST	STRING mensaje1 = "mensaje1 ERROR en el calculo CONDUCTIVIDAD del VAPOR: a esa P y T no existe vapor de agua, es líquido. \
					Por defecto se toma el valor correspondiente a vapor saturado a esa presión"

BODY
	tsat = temp_sat_w(P)

--	IF (T < tsat) THEN
--		cond = linearInterp1D(cond_vsat,P)	
--		PRINT (mensaje1)
	IF (T == tsat) THEN
		cond = linearInterp1D(cond_vsat,P)	
	ELSE 
		cond = cond_vsobre (T,P)
	END IF

	RETURN cond
END FUNCTION


-------------------------------------------------------------------------
-- CALOR ESPECÍFICO (kJ/kgºC) del vapor de agua en función de su temperatura (ºC) y presión (bar)

FUNCTION REAL cesp_vapor (REAL T, REAL P)
DECLS
	REAL cp
	REAL tsat
	CONST	STRING mensaje1 = "mensaje1 ERROR en el calculo CALOR ESPECÍFICO del VAPOR: a esa P y T no existe vapor de agua, es líquido. \
					Por defecto se toma el valor correspondiente a vapor saturado a esa presión"

BODY
	tsat = temp_sat_w(P)

--	IF (T < tsat) THEN
--		cp = linearInterp1D(cesp_vsat,P)	
--		PRINT (mensaje1)
	IF (T == tsat) THEN
		cp = linearInterp1D(cesp_vsat,P)	
	ELSE 
		cp = cesp_vsobre (T,P)
	END IF

	RETURN cp
END FUNCTION


------------------------------------------------------------------------------------------
-- NÚMERO DE PRANDLT del vapor de agua en función de su temperatura (ºC) y presión (bar)

FUNCTION REAL nPrand_vapor (REAL T, REAL P)
DECLS
	REAL nPr
	REAL tsat
	CONST	STRING mensaje1 = "mensaje1 ERROR en el calculo NÚMERO DE PRAND del VAPOR: a esa P y T no existe vapor de agua, es líquido. \
					Por defecto se toma el valor correspondiente a vapor saturado a esa presión"
BODY
	tsat = temp_sat_w(P)

--	IF (T < tsat) THEN
--		nPr = linearInterp1D(nPr_vsat,P)	
--		PRINT (mensaje1)
	IF (T == tsat) THEN
		nPr = linearInterp1D(nPr_vsat,P)	
	ELSE 
		nPr = nPrand_vsobre (T,P)
	END IF

	RETURN nPr
END FUNCTION

-------------------------------------------------------------------------
-- ENTROPÍA ESPECÍFICA (kJ/kgK) del vapor de agua en función de su temperatura (ºC) y presión (bar)

FUNCTION REAL entrop_vapor (REAL T, REAL P)
DECLS
	REAL S
	REAL tsat
	CONST	STRING mensaje1 = "mensaje1: ERROR en el calculo ENTROPÍA ESPECÍFICA del VAPOR: a esa P y T no existe vapor de agua, es líquido. \
					Por defecto se toma el valor correspondiente a vapor saturado a esa presión"
BODY
	tsat = temp_sat_w(P)

--	IF (T < tsat) THEN
--		S = linearInterp1D(entrop_vsat_T,T)
--		PRINT (mensaje1)
	IF (T == tsat) THEN
		S = linearInterp1D(entrop_vsat_T,T)
	ELSE 
		S = entrop_vsobre (T,P)
	END IF

	RETURN S
END FUNCTION

-------------------------------------------------------------------------
-- Temperatura del vapor de agua sobrecalentado en función de su entalpía (kJ/kg) y presión (bar)

FUNCTION REAL T_entalp_vsobre_H (REAL H, REAL P)
DECLS
	REAL T
BODY
-- Lo siguiente corresponde a vapor saturado. Pendiente de modificar para vapor sobrecalentado
	IF (H < 2804.5 AND P <30. ) THEN
		T = linearInterp1D(Tvs_H_baja, H)
	ELSE
		T = linearInterp1D(Tvs_H_alta, H)
	END IF

	RETURN T
END FUNCTION	

FUNCTION BOOLEAN setofCmp(SET_OF(products) Comp1, SET_OF(products) Comp2)
--Funcion para comparar dos enumerados
DECLS
    INTEGER n1, n2

BODY
    --Nota: setofSize devuelve el numero de elementos en en el SET_OF
    n1 = setofSize(Comp1)
    n2 = setofSize(Comp2)

    IF (n1 != n2) THEN
          RETURN FALSE
    END IF

    FOR (j IN 1, n1)
        --setofElem(Comp,j) devuelve el enumerado en la posicion j
        IF (setofElem(Comp1, j) != setofElem(Comp2, j)) THEN
             RETURN FALSE
        END IF
    END FOR

    RETURN TRUE
END FUNCTION



-----------------------------------------------------------------------------------------

FUNCTION NO_TYPE PresionVapor(SET_OF(Comp)mix,OUT REAL PSAT[Comp], IN REAL T)
DECLS
	INTEGER i = 0
BODY
 FOR(i IN mix)  
	  PSAT[i] = FCM*exp(PLXANT[i,1] + PLXANT[i,2]/(T + PLXANT[i,3]) + PLXANT[i,4]*T + PLXANT[i,5]*log(T) + PLXANT[i,6]*T**PLXANT[i,7])
 END FOR
END FUNCTION
-----------------------------------------------------------------------------------------
/*
FUNCTION NO_TYPE K_equilibrio(SET_OF(Comp)mix,OUT REAL K[Comp], IN REAL T)
DECLS
	INTEGER i = 0
	REAL P UNITS u_MPa "Presión" 
	REAL Psat[mix]
BODY
	FOR(i IN mix)
		PresionVapor(agua,Psat,T)
	   K[i]= Psat[i]/P
	END FOR
--	RETURN K
END FUNCTION
*/

-----------------------------------------------------------------------------------------

FUNCTION REAL GasIdeal(IN REAL P, IN REAL T)
DECLS
	REAL C_V UNITS u_kmol_m3 "Densidad molar"
BODY
 	C_V= P/(R*T)
	RETURN C_V
END FUNCTION

-----------------------------------------------------------------------------------------

COMPONENT DensidadGas

DECLS
 REAL RHO_V UNITS u_kg_m3 "Densidad másica"
 REAL y[Comp] UNITS no_units "Fracciones molares" 
 REAL PMm UNITS u_kg_kmol "Peso molecular medio"
 REAL P UNITS u_MPa "Presión" 
 REAL T UNITS u_K "Temperatura"

CONTINUOUS
  	  
	PMm = SUM (i IN Comp; y[i]*PM[i]) 
  	RHO_V = PMm * GasIdeal(P, T)
  	
END COMPONENT

FUNCTION REAL ENTALPIA_GAS_IDEAL(IN REAL T, IN REAL y[Comp])
	DECLS
	 CONST  REAL TREF = 298.15 --K  
    CONST  REAL DHFORM[Comp] = {-2.42E+08}   --J/kmol
	 CONST 	REAL CPIGDP[Comp,7] = {{33363, 26790, 2610.5, 8896, 1169, 100, 2273.15}} --J/kmol/K 
	
	 REAL H_i[Comp] UNITS u_MJ_kmol "Entalpía del gas ideal del componente"
	 REAL H_m UNITS u_MJ_kmol "Entalpía del gas ideal de la mezcla" 
--	 REAL T UNITS u_K "Temperatura"
--	 REAL y[Comp] UNITS no_units "Fracciones molares" 

BODY

 
 FOR( i IN Comp)   
  H_i[i] = FCM*(DHFORM[i] \
         + CPIGDP[i,1]*(T - TREF) \
			+ CPIGDP[i,2]*CPIGDP[i,3]*(1/tanh(CPIGDP[i,3]/T) - 1/tanh(CPIGDP[i,3]/TREF)) \      		
			- CPIGDP[i,4]*CPIGDP[i,5]*(tanh(CPIGDP[i,5]/T) - tanh(CPIGDP[i,5]/TREF))) --MJ/kmol
 END FOR			
						
  H_m = SUM (i IN Comp; y[i]*H_i[i]) 
RETURN H_m
END FUNCTION

-----------------------------------------------------------------------------------------

FUNCTION REAL DensidadLiquido (SET_OF(Comp)mix,IN REAL T,REAL x[mix])
-- Modelo de DIPPR con ecuación 116 para volumen molar de agua pura
-- Datos de Aspen Plus
DECLS
	 INTEGER i
	 REAL Vol_i[mix] UNITS u_m3_kmol "Volumen molar"
	 REAL VolM UNITS u_m3_kmol "Volumen molar"
	 REAL C_L UNITS u_kmol_m3 "Densidad molar"
	 REAL RHO_L UNITS u_kg_m3 "Densidad másica"
	 REAL PMm UNITS u_kg_kmol "Peso molecular medio"
	 REAL T_r[mix] UNITS no_units "Temperatura reducida" 
	 REAL tau[mix] UNITS no_units "Complemento de la temperatura reducida"
BODY
   FOR (i IN mix)
	  T_r[i]=T/TC[i]
	  tau[i] = 1 - T_r[i]
	  Vol_i[i] =1/ (DIPPR_116[i,1] + DIPPR_116[i,2]*tau[i]**0.35 + DIPPR_116[i,3]*tau[i]**(2/3) + DIPPR_116[i,4]*tau[i] + DIPPR_116[i,5]*tau[i]**(4/3))
	END FOR
	
	VolM = SUM (i IN mix; x[i]*Vol_i[i])
	PMm = SUM (i IN mix; x[i]*PM[i]) 
  	C_L = 1/VolM
	RHO_L=  PMm/VolM
	RETURN RHO_L
END FUNCTION


FUNCTION REAL EntalpiaGasIdeal(IN REAL T, IN REAL y[Comp])
	DECLS
	 CONST  REAL TREF = 298.15 --K  
    CONST  REAL DHFORM[Comp] = {-2.42E+08}   --J/kmol
	 CONST 	REAL CPIGDP[Comp,7] = {{33363, 26790, 2610.5, 8896, 1169, 100, 2273.15}} --J/kmol/K 
	
	 REAL H_i[Comp] UNITS u_MJ_kmol "Entalpía del gas ideal del componente"
	 REAL H_m UNITS u_MJ_kmol "Entalpía del gas ideal de la mezcla" 
BODY

 FOR( i IN Comp)   
  H_i[i] = FCM*(DHFORM[i] \
         + CPIGDP[i,1]*(T - TREF) \
			+ CPIGDP[i,2]*CPIGDP[i,3]*(1/tanh(CPIGDP[i,3]/T) - 1/tanh(CPIGDP[i,3]/TREF)) \      		
			- CPIGDP[i,4]*CPIGDP[i,5]*(tanh(CPIGDP[i,5]/T) - tanh(CPIGDP[i,5]/TREF))) --MJ/kmol
 END FOR			
						
  H_m = SUM (i IN Comp; y[i]*H_i[i]) 
RETURN H_m
END FUNCTION

-----------------------------------------------------------------------------------------
FUNCTION NO_TYPE DHvap_DIPPR (OUT REAL DHvap[Comp], IN REAL T, IN REAL y[Comp])
DECLS
	INTEGER i = 0
BODY
FOR (i IN Comp)   	
	IF (T<TC[i]) THEN
		DHvap[i] = FCM*(DHVLDP[i,1]*(1-T/TC[i])**(DHVLDP[i,2] + DHVLDP[i,3]*(T/TC[i]) \
		         + DHVLDP[i,4]*(T/TC[i])**2 + DHVLDP[i,5]*(T/TC[i])**3)) --/kmol
	ELSE
		DHvap[i] = 0
	END IF
END FOR
END FUNCTION

-----------------------------------------------------------------------------------------
FUNCTION REAL EntalpiaLiquidoIdeal (SET_OF(Comp)mix, IN REAL T, IN REAL x[mix])
DECLS
 INTEGER i
 REAL H_v UNITS u_MJ_kmol "Entalpía del gas ideal de la mezcla"
 REAL H_m UNITS u_MJ_kmol "Entalpía del líquido de la mezcla" 
 REAL DHvap[mix]
BODY
 --Entalpía del vapor 
	H_v = ENTALPIA_GAS_IDEAL(T, x)
	DHvap_DIPPR(DHvap,T,x)
--Entalpía del líquido
   H_m = H_v - SUM(i IN mix; x[i]*DHvap[i])
	RETURN H_m

END FUNCTION

